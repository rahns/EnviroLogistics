{"version":3,"sources":["Optimise.js","Classes.js","components/MapBox.js","components/CheckboxList.js","AddTrip/SelectWaypoints.js","components/DnDListofLists/ListItemCustom.js","components/DnDListofLists/Column.js","components/DnDListofLists/DnDListofLists.js","AddTrip/AssignVehicles.js","AddTrip/ExtraDetails.js","AddTrip.js","components/TripAccordian.js","Trips.js","FleetPageComponents.js","Fleet.js","components/Report.js","Analysis.js","Main.js","App.js","reportWebVitals.js","index.js"],"names":["optimise","tripDate","vehicleList","locationList","depotLocation","notes","a","matrix_data","getMatrices","planObj","jobs","generateDeliveriesList","length","map","e","id","JSON","stringify","deliveries","fleetObj","profiles","vehicles","generateVehiclesList","problemObj","plan","fleet","objectives","config","console","log","window","init","then","data","responseToTrip","solve_pragmatic","result","locations","long","lat","forEach","push","bodyData","fetch","method","mode","headers","process","body","response","json","distances","l","Math","round","flat","distanceMatrix","durations","durationMatrix","concat","numberOfDeliveries","deliveriesList","i","places","location","index","duration","demand","typeId","vehicleIds","profile","costs","fixed","distance","avgEmissionsPerKm","time","shifts","start","earliest","end","latest","capacity","limits","date","locationIndexMapping","parse","tours","vehicleTrips","Promise","all","tour","tourToVehicleTrip","Trip","vehicle","vehicleId","tripLegs","stops","startLocation","endLocation","getDirections","directions","error","alert","nickname","message","leg","TripLeg","features","properties","summary","undefined","VehicleTrip","request_url","base_url","Vehicle","make","model","year","autoTransmission","this","obj","dbKey","Location","errorStatus","legEmissions","colour","geometry","coordinates","startNum","endNum","startPopup","mapboxgl","Popup","offset","setText","endPopup","startMarker","document","createElement","className","innerHTML","endMarker","String","Marker","setLngLat","setPopup","MapState","getMapMarkersList","getDirectionsGeometry","reduce","accumulator","currentTripLeg","vehicleDistance","vehicleDuration","vehicleEmissions","depot","excludeDepotMarker","markersList","directionsGeometery","markers","paths","other","coords","filter","Array","lats","lngs","minLat","min","apply","maxLat","max","currentVehicleTrip","totalDuration","emissions","consecutiveDuration","colours","distinctColors","count","lightMin","chromaMin","hex","mapState","combine","getMapState","Date","rego","t","coles","woolworths","monash","gmhbastadium","melbournecentral","mcg","operahouse","carList","getExampleCars","includes","parseInt","createInitialVehicles","MapBox","height","width","mapContainer","React","useRef","useState","mapReady","setMapReady","currentMapState","setCurrentMapState","useEffect","current","Map","container","style","center","zoom","addControl","NavigationControl","on","remove","getSource","toString","removeLayer","removeSource","addTo","addSource","addLayer","bbox","getBoundingBox","fitBounds","padding","setCenter","setZoom","updateMap","controls","element","control","position","hasControl","ref","borderRadius","accessToken","useStyles","makeStyles","theme","root","maxWidth","backgroundColor","palette","background","paper","CheckboxList","items","checked","handleToggle","deletable","handleDelete","classes","List","item","labelId","ListItem","dense","button","onClick","ListItemIcon","Checkbox","edge","indexOf","tabIndex","disableRipple","inputProps","ListItemText","primary","ListItemSecondaryAction","IconButton","SelectWaypoints","locsChecked","setLocsChecked","setDepot","setErrorText","setSnackbar","locNickname","setlocNickname","setLocations","geocoderResult","setGeocoderResult","geocoder","MapboxGeocoder","marker","proximity","latitude","longitude","Grid","xs","display","flexDirection","TextField","label","onChange","target","value","Button","variant","color","dupeNick","dupeLoc","errorText","addLocation","marginLeft","maxHeight","overflow","marginTop","minWidth","select","size","SelectProps","event","loc","MenuItem","ListItemCustom","itemObject","draggableId","provided","innerRef","draggableProps","dragHandleProps","role","ContainerComponent","content","Column","column","margin","Typography","droppableId","droppableProps","list","placeholder","DragDropListOfLists","stateUpdater","state","onDragEnd","source","destination","newList","_","idx","splice","newCol","newStartList","newStartCol","newEndList","newEndCol","direction","justifyContent","Object","values","AssignVehicles","vehiLocs","setVehiLocs","vehiChecked","setVehiChecked","cars","depotPos","noDepotLocs","slice","initVehiLocs","textAlign","locs","chunkedLocs","array","parts","ceil","splitToChunks","veh","ExtraDetails","setTrip","currentTrip","selectedDate","handleDateChange","setNotes","noDepot","depotAndLocs","vehiLoctoTour","vehiLoc","keys","prev","key","tripMode","setTripMode","setMapState","getUnoptimised","trip","newTrip","handleRadio","DateTimePicker","autoOk","ampm","disablePast","showTodayButton","RadioGroup","row","FormControlLabel","Radio","multiline","AddTrip","props","steps","activeStep","setActiveStep","snackbarOpen","step","getStepContent","disabled","prevActiveStep","addToDatabase","pageUpdater","Trips","user","Stepper","Step","StepLabel","Snackbar","open","autoHideDuration","onClose","elevation","severity","updater","currentIndex","newChecked","newItems","Accordion","wrapChipRoot","wrapChipLabel","marginBottom","overflowWrap","whiteSpace","textOverflow","handleViewMap","modalOpener","stopPropagation","TripAccordian","VehicleAccordian","vehicleTrip","dialogState","setDialogState","handleDialogClose","expanded","changeHandler","AccordionSummary","expandIcon","ExpandMore","alignItems","marginRight","paddingRight","Chip","icon","Event","getDate","getMonth","getFullYear","Tooltip","title","Timer","AvTimer","Straighten","Store","Room","acc","v","LocalShipping","Eco","gap","startIcon","AccordionDetails","Divider","AccordionActions","Dialog","DialogTitle","DialogActions","database","uid","autoFocus","legs","DisplayLeg","minHeight","paddingTop","navURL","flexWrap","href","Navigation","filterTrips","allTripsList","currentTripsList","searchText","toLowerCase","toDateString","setFilter","search","setTrips","setAllTrips","stillLoading","setStillLoading","showTrips","setShowTrips","modalState","setModalOpen","mapIsLoaded","setMapIsLoaded","setExpanded","handleChange","panel","isExpanded","snapshot","allTrips","snap","objectToInstance","val","ReferenceError","err","addTestTrips","errorHandler","sort","b","trips","tripComponents","LinearProgress","Grow","in","timeout","type","zIndex","top","left","pointerEvents","Backdrop","Cancel","fontSize","Card","VehicleCard","avgEmissions","CardContent","Build","CardActions","filterVehicles","allVehicles","currentVehicles","Fleet","filteredVehicles","setVehicles","setAllVehicles","showFleet","setShowFleet","transmission","setTransmission","handleTransmissionSelect","getElementById","setAttribute","addVehicle","getAttribute","newVehicle","vehicleComponents","dummyVehicles","marginCenter","action","trigger","modal","nested","close","align","InputProps","shrink","endAdornment","InputAdornment","addTestVehicles","calculateMonthStats","month","Number","POSITIVE_INFINITY","total","Report","selectedYear","setYear","selectedMonth","setMonth","avg","setAvg","setMax","setMin","setTotal","mtotal","FormControl","InputLabel","Select","DatePicker","inputVariant","views","Statistic","boxShadow","Analysis","setData","monthly","setMonthly","yearly","setYearly","maximum","setMaximum","minimum","setMinimum","graphType","setGraphType","graphPeriod","setPeriod","found","j","name","Gas","foundd","component","FormLabel","defaultValue","ResponsiveContainer","BarChart","bottom","right","CartesianGrid","strokeDasharray","XAxis","dataKey","dy","YAxis","Bar","unit","fill","LineChart","Line","stroke","activeDot","r","Main","navState","setValue","activePage","handleClickLogout","firebase","auth","currentUser","photoURL","username","displayName","email","path","utils","DateFnsUtils","paddingBottom","avatar","Avatar","src","toUpperCase","BottomNavigation","showLabels","newValue","BottomNavigationAction","Timeline","ExitToApp","DialogContent","signOut","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","databaseURL","measurementId","initializeApp","App","msgState","setMsgOpen","handleMsgClose","reason","loginUIConfig","signInFlow","signInOptions","GoogleAuthProvider","PROVIDER_ID","provider","EmailAuthProvider","requireDisplayName","callbacks","signInSuccessWithAuthResult","emailVerified","sendEmailVerification","createTheme","main","secondary","ThemeProvider","transitionDelay","uiConfig","firebaseAuth","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render"],"mappings":"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","file":"static/js/main.f96cc710.chunk.js","sourcesContent":["import { Trip, VehicleTrip, TripLeg } from \"./Classes\";\r\n\r\nexport async function optimise(tripDate, vehicleList, locationList, depotLocation, notes) {\r\n    // Get distance matrix:\r\n    let matrix_data = getMatrices(locationList, depotLocation);\r\n    \r\n    // Construct problem for passing to solver:\r\n    let planObj = {jobs: generateDeliveriesList(locationList.length).map(e => {\r\n        return {id: JSON.stringify(e), deliveries: [e]}\r\n    })};\r\n    let fleetObj = {\r\n        profiles: [{\"name\": \"normal\"}], \r\n        vehicles: generateVehiclesList(vehicleList)\r\n    };\r\n\r\n    let problemObj = {\r\n        plan: planObj, \r\n        fleet: fleetObj, \r\n        objectives: [\r\n            [\r\n                {\r\n                    \"type\": \"minimize-unassigned\"\r\n                }\r\n            ],\r\n            [\r\n                {\r\n                    \"type\": \"minimize-cost\"\r\n                },\r\n                {\r\n                    \"type\": \"minimize-distance\"\r\n                },\r\n                {\r\n                    \"type\": \"maximize-tours\"\r\n                },\r\n                // {\r\n                //     \"type\": \"minimize-duration\"\r\n                // }\r\n            ]\r\n        ]\r\n    };\r\n\r\n    const config = {\r\n        \"termination\": {\r\n             \"maxTime\": 5,\r\n        }\r\n    };\r\n\r\n    console.log(problemObj)\r\n\r\n    // Initialise and call solver:\r\n    await window.init();\r\n    let result;\r\n    await matrix_data.then(async data => result = await responseToTrip(\r\n            tripDate, \r\n            window.solve_pragmatic(problemObj, data[1], config), \r\n            data[0], notes)\r\n    );\r\n    return result;\r\n}\r\n\r\nasync function getMatrices(locationList, depotLocation) {\r\n    const base_url = \"https://api.openrouteservice.org/v2/matrix/driving-car\";\r\n    let locations = [[depotLocation.long, depotLocation.lat]];\r\n    locationList.forEach(e => locations.push([e.long, e.lat]));\r\n    const bodyData = {\"locations\":locations,\"metrics\":[\"distance\",\"duration\"],\"units\":\"m\"};\r\n    const response = await fetch(base_url, {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        headers: {\r\n          'Accept': 'application/json, application/geo+json, application/gpx+xml, img/png; charset=utf-8',\r\n          'Content-Type': 'application/json',\r\n          'Authorization': process.env.REACT_APP_OPENROUTESERVICE_API_KEY\r\n        },\r\n        body: JSON.stringify(bodyData)\r\n      });\r\n    let data = await response.json();\r\n    let distanceMatrix = await data.distances.map((e) => (e.map((l) => Math.round(l)))).flat();\r\n    let durationMatrix = await data.durations.map((e) => (e.map((l) => Math.round(l/60)))).flat();\r\n    return [\r\n        [depotLocation].concat(locationList), \r\n        ([{\r\n            \"matrix\": \"normal\",\r\n            \"distances\": distanceMatrix,\r\n            \"travelTimes\": durationMatrix \r\n        }])\r\n    ]\r\n}\r\n\r\nfunction generateDeliveriesList(numberOfDeliveries) {\r\n    let deliveriesList = [];\r\n    for (let i = 0; i < numberOfDeliveries; i++) {\r\n        deliveriesList.push(\r\n            {\r\n                places: [\r\n                    {\r\n                        location: {\r\n                            index: i+1\r\n                        },\r\n                        duration: 0\r\n                    }\r\n                ],\r\n                demand: [0]\r\n            }\r\n        );\r\n    }\r\n    return deliveriesList;\r\n}\r\n\r\nfunction generateVehiclesList(vehicleList) {\r\n    return vehicleList.map(i => (\r\n        {\r\n            typeId: JSON.stringify(i),\r\n            vehicleIds: [JSON.stringify(i)],\r\n            profile: {\r\n                \"matrix\": \"normal\"\r\n            },\r\n            costs: {fixed: 71000, distance: i.avgEmissionsPerKm, time: 450},\r\n            // costs: {fixed: 0, distance: i.avgEmissionsPerKm, time: 0},\r\n            shifts: [{\r\n                start: {\r\n                    earliest: \"1900-01-01T00:00:00Z\",\r\n                    location: {\r\n                        index: 0\r\n                    }\r\n                },\r\n                end: {\r\n                    latest: \"2200-01-01T00:00:00Z\",\r\n                    location: {\r\n                        index: 0\r\n                    }\r\n                }\r\n            }],\r\n            capacity: [1],\r\n            limits: {}\r\n        }\r\n    ))\r\n}\r\n\r\nasync function responseToTrip(date, response, locationIndexMapping, notes) {\r\n    console.log(locationIndexMapping)\r\n    \r\n\r\n    response = JSON.parse(response);\r\n    console.log(response)\r\n    console.log(response.tours.length)\r\n    let vehicleTrips = Promise.all(response.tours.map(async tour => await tourToVehicleTrip(tour, locationIndexMapping)));\r\n\r\n    return new Trip(date, await vehicleTrips, notes);\r\n}\r\n\r\nexport async function tourToVehicleTrip(tour, locationIndexMapping) {\r\n    let vehicle = JSON.parse(tour.vehicleId);\r\n\r\n    let tripLegs = [];\r\n    let stops = tour.stops;\r\n\r\n    for (let i = 1; i < stops.length; i++) {\r\n        let startLocation = locationIndexMapping[stops[i-1].location.index];\r\n        let endLocation = locationIndexMapping[stops[i].location.index];\r\n        let directions = await getDirections(startLocation, endLocation)\r\n        if (directions.error) {alert(\r\n            \"Couldn't find a driveable route between \" + startLocation.nickname + \" and \" + endLocation.nickname + \". \\nError code: \"+ directions.error.message)}\r\n        let leg = new TripLeg(\r\n                startLocation,\r\n                endLocation,\r\n                directions.error ? 0 : Math.round(directions.features[0].properties.summary.duration / 60),\r\n                directions.error ? 0 : Math.round(directions.features[0].properties.summary.distance / 1000),\r\n                vehicle,\r\n                directions.error ? undefined : directions.features[0], \r\n                directions.error\r\n        )\r\n        tripLegs.push(leg);\r\n    }\r\n\r\n    return new VehicleTrip(vehicle, tripLegs);\r\n}\r\n\r\nexport async function getDirections(start, end) {\r\n    let base_url = \"https://api.openrouteservice.org/v2/directions/driving-car?api_key=\" + process.env.REACT_APP_OPENROUTESERVICE_API_KEY + \"&\";\r\n    let request_url = base_url + \"start=\" + start.long + \",\" + start.lat + \"&end=\" + end.long + \",\" + end.lat\r\n    const response = await fetch(request_url, {mode: 'cors'})\r\n\r\n    return response.json()\r\n}","import { optimise } from \"./Optimise\";\r\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\r\nimport distinctColors from 'distinct-colors'\r\nimport './App.css';\r\nimport data from './data/vehicles.json';\r\n\r\n\r\nexport class Vehicle {\r\n  constructor(make, model, year, autoTransmission, avgEmissionsPerKm) {\r\n    this.make = make;\r\n    this.model = model;\r\n    this.year = year;\r\n    this.autoTransmission = autoTransmission;\r\n    this.avgEmissionsPerKm = avgEmissionsPerKm;\r\n  }\r\n\r\n  toString() {\r\n    return this.make + \" \" + this.model + \" \" + this.year;\r\n  }\r\n\r\n  objectToInstance(obj, dbKey) {\r\n    this.dbKey = dbKey;\r\n    this.make = obj.make;\r\n    this.model = obj.model;\r\n    this.year = obj.year;\r\n    this.autoTransmission = obj.autoTransmission;\r\n    this.avgEmissionsPerKm = obj.avgEmissionsPerKm;\r\n  }\r\n};\r\n\r\nexport class Location {\r\n  constructor(lat, long, nickname) {\r\n    this.lat = lat;\r\n    this.long = long;\r\n    this.nickname = nickname;\r\n  }\r\n\r\n  toString() {\r\n    return this.nickname;\r\n  }\r\n}\r\n\r\nexport class TripLeg {\r\n  constructor(startLocation, endLocation, duration, distance, vehicle, directions, errorStatus) {\r\n    this.startLocation = startLocation;\r\n    this.endLocation = endLocation;\r\n    this.duration = duration;\r\n    this.distance = distance;\r\n    this.vehicle = vehicle;\r\n    this.directions = directions;\r\n    this.legEmissions = vehicle.avgEmissionsPerKm * distance;\r\n    this.errorStatus = errorStatus;\r\n  }\r\n\r\n  getDirectionsGeometry(colour) { \r\n    if (this.directions && !this.errorStatus) {\r\n      return [this.directions.geometry.coordinates, colour]\r\n    } \r\n    else {\r\n      return [[[this.startLocation.long, this.startLocation.lat], this.endLocation.long, this.endLocation.lat], 'black']\r\n    }\r\n  }\r\n\r\n  getMapMarkersList(colour, startNum, endNum) {\r\n    if (!colour) {colour = '#9a53a0'}\r\n    if (!startNum) {startNum = 1}\r\n    const startPopup = new mapboxgl.Popup({ offset: 25 }).setText(\r\n      this.startLocation.nickname\r\n      );\r\n    const endPopup = new mapboxgl.Popup({ offset: 25 }).setText(\r\n      this.endLocation.nickname\r\n      );\r\n    var startMarker = document.createElement('div');\r\n    startMarker.className = 'marker';\r\n    startMarker.innerHTML = '<span style=\"background: ' + colour + ';\"><b>' + (startNum) + '</b></span>'\r\n    var endMarker = document.createElement('div');\r\n    endMarker.className = 'marker';\r\n    endMarker.innerHTML = '<span style=\"background: ' + colour + ';\"><b>' + (endNum ? endNum : startNum instanceof String ? 1 : startNum + 1) + '</b></span>'\r\n    if (this.directions) {\r\n      return [\r\n        new mapboxgl.Marker(startMarker).setLngLat([this.startLocation.long, this.startLocation.lat]).setPopup(startPopup),\r\n        new mapboxgl.Marker(endMarker).setLngLat([this.endLocation.long, this.endLocation.lat]).setPopup(endPopup)\r\n    ];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  getMapState(colour) {\r\n    if (!colour) {colour = '#9a53a0'}\r\n    return new MapState(this.getMapMarkersList(colour, \"A\", \"B\"), this.directions ? [this.getDirectionsGeometry(colour)] : [])\r\n  }\r\n};\r\n\r\nexport class VehicleTrip {\r\n  constructor(vehicle, tripLegs) {\r\n    this.vehicle = vehicle;\r\n    this.tripLegs = tripLegs;\r\n    [this.vehicleDistance, this.vehicleDuration] = tripLegs.reduce(\r\n      (accumulator, currentTripLeg) =>\r\n        [accumulator[0] + currentTripLeg.distance, accumulator[1] + currentTripLeg.duration], [0, 0]\r\n    );\r\n    this.vehicleEmissions = vehicle.avgEmissionsPerKm * this.vehicleDistance;\r\n    this.depot = tripLegs[0].startLocation;\r\n  }\r\n\r\n  getMapState(colour, excludeDepotMarker) {\r\n    if (!colour) {colour = '#9a53a0'};\r\n    let markersList = []\r\n    let directionsGeometery = []\r\n    for (let i = 0; i < this.tripLegs.length; i++) {\r\n      if (this.tripLegs[i].directions) {\r\n        if (i !== 0 || !excludeDepotMarker) {markersList.push(this.tripLegs[i].getMapMarkersList(i === 0 ? \"black\" : colour, i === 0 ? \"D\" : i)[0])};\r\n        directionsGeometery.push(this.tripLegs[i].getDirectionsGeometry(colour))\r\n      }\r\n    }\r\n    return new MapState(markersList, directionsGeometery)\r\n  }\r\n}\r\n\r\nexport class MapState {\r\n  constructor(markers, paths) {\r\n    this.markers = markers;\r\n    this.paths = paths;    \r\n  }\r\n\r\n  combine(other) {\r\n    this.markers = this.markers.concat(other.markers);\r\n    this.paths = this.paths.concat(other.paths);\r\n  }\r\n\r\n  getBoundingBox() {\r\n    if (this.paths.length !== 0) {\r\n      var coords = this.paths.flat().flat().filter((e) => (e instanceof Array));\r\n      var lats = coords.map((e) => e[1])\r\n      var lngs = coords.map((e) => e[0])\r\n      // calc the min and max lng and lat\r\n      var minLat = Math.min.apply(null, lats);\r\n      var maxLat = Math.max.apply(null, lats);\r\n      var minLng = Math.min.apply(null, lngs);\r\n      var maxLng = Math.max.apply(null, lngs);\r\n      return [[minLng, minLat],[maxLng, maxLat]];\r\n    }\r\n    return undefined\r\n  }\r\n}\r\n\r\nexport class MapVehicleTripData {\r\n  constructor(vehicleTrip) {\r\n    for (let i = 0; i < vehicleTrip.tripLegs.length; i++) {\r\n\r\n    }\r\n  }\r\n}\r\n\r\nexport class Trip {\r\n  constructor(date, vehicleTrips, notes) {\r\n    this.date = date;\r\n    this.notes = notes;\r\n    this.vehicleTrips = vehicleTrips;\r\n    if (vehicleTrips !== undefined) {\r\n      [this.distance, this.totalDuration, this.emissions, this.consecutiveDuration] = vehicleTrips.reduce(\r\n        (accumulator, currentVehicleTrip) =>\r\n          [\r\n            accumulator[0] + currentVehicleTrip.vehicleDistance,\r\n            accumulator[1] + currentVehicleTrip.vehicleDuration,\r\n            accumulator[2] + currentVehicleTrip.vehicleEmissions,\r\n            Math.max(accumulator[3], currentVehicleTrip.vehicleDuration)\r\n          ],\r\n        [0, 0, 0, 0]\r\n      );\r\n      this.depot = vehicleTrips[0].depot;\r\n    }\r\n  }\r\n\r\n  getMapState() {\r\n    const colours = distinctColors({count: this.vehicleTrips.length, lightMin: 30, chromaMin: 50}).map(e => e.hex())\r\n    var mapState = new MapState([], [])\r\n    for (let i = 0; i < this.vehicleTrips.length; i++) {\r\n      mapState.combine(this.vehicleTrips[i].getMapState(colours[i%colours.length], i === 0 ? false : true))\r\n    }\r\n    return mapState;\r\n  }\r\n\r\n  objectToInstance(obj, dbKey) {\r\n    this.dbKey = dbKey;\r\n    this.notes = obj.notes;\r\n    this.consecutiveDuration = obj.consecutiveDuration;\r\n    this.depot = obj.depot;\r\n    this.date = new Date(Date.parse(obj.date));\r\n    this.distance = obj.distance;\r\n    this.emissions = obj.emissions;\r\n    this.totalDuration = obj.totalDuration;\r\n    this.vehicleTrips = obj.vehicleTrips.map((e) => new VehicleTrip(\r\n      new Vehicle(e.vehicle.make, e.vehicle.model, e.vehicle.year, e.vehicle.autoTransmission, e.vehicle.avgEmissionsPerKm, e.vehicle.rego),\r\n      e.tripLegs.map((t) => new TripLeg(new Location(t.startLocation.lat, t.startLocation.long, t.startLocation.nickname),\r\n        new Location(t.endLocation.lat, t.endLocation.long, t.endLocation.nickname), t.duration, t.distance,\r\n        new Vehicle(t.vehicle.make, t.vehicle.model, t.vehicle.year, t.vehicle.autoTransmission, t.vehicle.avgEmissionsPerKm, t.vehicle.rego), t.directions, t.errorStatus))))\r\n\r\n  }\r\n};\r\n\r\n// Example locations\r\nconst depot = new Location(-37.871011482016286, 145.02958519226144, \"AusPost Caulfield\");\r\nconst coles = new Location(-37.88547095750236, 145.08436342596195, \"Coles\");\r\nconst woolworths = new Location(-37.94903921470658, 145.0406876435942, \"Woolworths\");\r\nconst monash = new Location(-37.91430871112805, 145.1349541627051, \"Monash University\");\r\nconst gmhbastadium = new Location(-38.15806474307235, 144.35463009484664, \"GMHBA Stadium\");\r\nconst melbournecentral = new Location(-37.8101676448892, 144.96272227875326, \"Melbourne Central\");\r\nconst mcg = new Location(-37.81989845691743, 144.98336346301312, \"Melbourne Cricket Ground\");\r\nconst operahouse = new Location(-33.85678377807042, 151.21533961793205, \"Sydney Opera House\");\r\n\r\nconst carList = [];\r\nfunction createInitialVehicles() {\r\n  for(let i = 0; i < data[\"21\"].length; i=i+20) {\r\n    const make = data[\"21\"][i][\"Mfr Name\"];\r\n    const model = data[\"21\"][i][\"Carline\"];\r\n    const year = data[\"21\"][i][\"Model Year\"];\r\n    var autoTransmission;\r\n    if (data[\"21\"][i][\"Trans\"] === \"A\"|data[\"21\"][i][\"Transmission\"].includes(\"Auto\")) {\r\n      autoTransmission = true;\r\n    }\r\n    else {\r\n      autoTransmission = false;\r\n    }\r\n    const avgEmissionsPerKm = Math.round(parseInt(data[\"21\"][i][\"Comb CO2 Rounded Adjusted (as shown on FE Label)\"])/1.6);  // convert to per km from per mile\r\n    carList.push(new Vehicle(make, model, year, autoTransmission, avgEmissionsPerKm))\r\n  }\r\n}\r\ncreateInitialVehicles();\r\n\r\nexport function getExampleCars() {\r\n  return carList;\r\n}\r\n\r\nexport function getExampleLocations() {\r\n  return [depot, coles, woolworths];\r\n}\r\n\r\nexport function getExampleLocationsNoDepot() {\r\n  return [coles, woolworths];\r\n}\r\n\r\nexport function getExampleOptimisedTrip() {\r\n  return optimise(new Date('8/20/2021'), carList, [coles, woolworths], depot, \"Example optimised trip; \" + carList.length + \" vehicles available, 2 delivery jobs, close-range\");\r\n}\r\n\r\nexport function getExampleOptimisedTrip2() {\r\n  return optimise(new Date('8/2/2029'), carList, [coles, woolworths, monash, gmhbastadium, melbournecentral, mcg, operahouse], depot, \"Example optimised trip; \" + carList.length + \" vehicles available, 7 delivery jobs, long-range\");\r\n}\r\n\r\nexport function getExampleOptimisedTrip3() {\r\n  return optimise(new Date('8/3/2021'), carList, [coles, woolworths, monash, melbournecentral, mcg], depot, \"Example optimised trip; \" + carList.length + \" vehicles available, 5 delivery jobs, mid-range\");\r\n}\r\n","// Adapted from https://docs.mapbox.com/help/tutorials/use-mapbox-gl-js-with-react/\n\nimport React from 'react';\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\nimport { MapState } from '../Classes';\n\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_API_KEY;\n\nexport default function MapBox({ height, width, mapState }) {\n    const mapContainer = React.useRef(null);\n    const map = React.useRef(null);\n    const [mapReady, setMapReady] = React.useState(false);\n    const [currentMapState, setCurrentMapState] = React.useState(undefined);\n\n    const updateMap = () => {\n        if (currentMapState) {\n            for (let i = 0; i < currentMapState.markers.length; i++) { currentMapState.markers[i].remove(); console.log('done removing markers') }; // remove existing markers\n            for (let i = 0; i < currentMapState.paths.length; i++) {if (map.current.getSource(i.toString())) {map.current.removeLayer(i.toString()); map.current.removeSource(i.toString()); console.log('done removing paths')}} // remove any existing path lines on the map\n        }\n\n        if (mapState) {\n            if (mapState.markers) {\n                for (let i = 0; i < mapState.markers.length; i++) {\n                    mapState.markers[i].addTo(map.current);\n                }\n            }\n            if (mapState.paths) {\n                for (let i = 0; i < mapState.paths.length; i++) {\n                    map.current.addSource(i.toString(), \n                    {\n                        'type': 'geojson',\n                        'data': {\n                            'type': 'Feature',\n                            'properties': {},\n                            'geometry': {\n                            'type': 'LineString',\n                            'coordinates': mapState.paths[i][0]\n                            }\n                        }\n                    });\n                    map.current.addLayer({\n                        'id': i.toString(),\n                        'type': 'line',\n                        'source': i.toString(),\n                        'layout': {\n                            'line-join': 'round',\n                            'line-cap': 'round'\n                        },\n                        'paint': {\n                            'line-color': mapState.paths[i][1],\n                            'line-width': 8\n                        }\n                    });\n                }\n            }\n            \n            let bbox = mapState.getBoundingBox()\n            if (bbox) {\n                map.current.fitBounds(bbox, {padding: 60});\n            }\n            else {\n                map.current.setCenter([144.946457, -37.840935]);\n                map.current.setZoom(9);\n            }\n            \n            setCurrentMapState(mapState);\n        }\n    }\n\n    React.useEffect(() => {\n        if (map.current) return; // initialize map only once\n        map.current = new mapboxgl.Map({\n            container: mapContainer.current,\n            style: 'mapbox://styles/mapbox/streets-v11',\n            center: [144.946457, -37.840935],\n            zoom: 9\n        });\n\n        console.log(\"Map initialised\");\n\n        map.current.addControl(new mapboxgl.NavigationControl());\n        \n        map.current.on('load', () => setMapReady(true))\n    });\n\n    React.useEffect(() => {\n        if (mapReady && mapState instanceof MapState) {\n            updateMap();   \n        }\n        if (mapState && mapState.controls) {\n            mapState.controls.forEach((element) => {\n                let control = element.control;\n                let position = element.position;\n                if (!map.current.hasControl(control)) {\n                    // At this point we're assuming controls are never removed\n                    map.current.addControl(control, position);\n                }\n            })\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [mapState, mapReady])  // Runs only when mapState or mapReady changes\n    \n    return (\n        <div>\n            <div ref={mapContainer} style={{height: height, width: width, borderRadius: \"13px\"}} />\n        </div>\n    )\n}\n","// Adapted from https://material-ui.com/components/lists/\r\n// Assumes each list element has a toString method defined\r\n\r\nimport React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        width: '100%',\r\n        maxWidth: 360,\r\n        backgroundColor: theme.palette.background.paper,\r\n    },\r\n}));\r\n\r\nexport default function CheckboxList({ items, checked, handleToggle, deletable, handleDelete }) {\r\n    const classes = useStyles();\r\n    return (\r\n        <List className={classes.root}>\r\n            {items.map((item, index) => {\r\n                const labelId = `checkbox-list-label-${index}`;\r\n\r\n                return (\r\n                    <ListItem key={index} dense button onClick={handleToggle(checked)(item)}>\r\n                        <ListItemIcon>\r\n                            <Checkbox\r\n                                edge=\"start\"\r\n                                checked={checked.indexOf(item) !== -1}\r\n                                tabIndex={-1}\r\n                                disableRipple\r\n                                inputProps={{ 'aria-labelledby': labelId }}\r\n                            />\r\n                        </ListItemIcon>\r\n                        <ListItemText id={labelId} primary={item.toString()} />\r\n                        {!(deletable == null) && !(handleDelete == null) && deletable ?\r\n                            <ListItemSecondaryAction>\r\n                                <IconButton edge=\"end\" aria-label=\"delete\" onClick={handleDelete(items)(item)}>\r\n                                    <DeleteIcon />\r\n                                </IconButton>\r\n                            </ListItemSecondaryAction> : <></>}\r\n                    </ListItem>\r\n                );\r\n            })}\r\n        </List>\r\n    );\r\n}","import React from 'react';\r\nimport '../App.css';\r\nimport MapBox from '../components/MapBox.js'\r\nimport MapboxGeocoder from '@mapbox/mapbox-gl-geocoder';\r\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\r\nimport '@mapbox/mapbox-gl-geocoder/dist/mapbox-gl-geocoder.css';\r\nimport CheckboxList from '../components/CheckboxList.js'\r\nimport { Button, Grid, TextField, MenuItem } from \"@material-ui/core\";\r\nimport { getExampleLocations, Location } from '../Classes';\r\n\r\nexport default function SelectWaypoints({ locsChecked, setLocsChecked, handleToggle, handleDelete, depot, setDepot, setErrorText, setSnackbar }) {\r\n  const [locNickname, setlocNickname] = React.useState('');\r\n  const [locations, setLocations] = React.useState(getExampleLocations());\r\n  const [geocoderResult, setGeocoderResult] = React.useState([]);\r\n\r\n  const geocoder = new MapboxGeocoder({\r\n    accessToken: process.env.REACT_APP_MAPBOX_API_KEY,\r\n    marker: true,\r\n    mapboxgl: mapboxgl,\r\n    proximity: {\r\n      // Prioritise coordinates near Melbourne\r\n      latitude: -37.8136,\r\n      longitude: 144.9631\r\n    }\r\n  })\r\n    .on('result', ({ result }) => {\r\n      setGeocoderResult(result.geometry.coordinates);\r\n    });;\r\n\r\n  const [mapState] = React.useState({\r\n    controls: [{\r\n      control: geocoder,\r\n      position: \"top-left\"\r\n    }]\r\n  });\r\n\r\n  const addLocation = () => {\r\n    let dupeNick = false;\r\n    let dupeLoc = false;\r\n    locations.forEach(function (element) {\r\n      if (element.nickname === locNickname) {\r\n        dupeNick = true;\r\n      }\r\n      if (element.lat === geocoderResult[1] && element.long === geocoderResult[0]) {\r\n        dupeLoc = true;\r\n      }\r\n    });\r\n\r\n    //console.log(geocoderResult);\r\n\r\n    if (geocoderResult.length !== 0 && locNickname !== '' && !dupeNick) {\r\n      setLocations([new Location(geocoderResult[1], geocoderResult[0], locNickname), ...locations]);\r\n      console.log(\"added location \" + locNickname + \" at coordinates \" + geocoderResult[1].toString() + \" \" + geocoderResult[0].toString())\r\n    }\r\n    else {\r\n      let errorText = 'Waypoint not added: '\r\n      errorText = geocoderResult.length === 0 ? errorText + 'No marker specified!'\r\n        : locNickname === '' ? errorText + 'No nickname given!'\r\n          : dupeNick ? errorText + 'Duplicate Nickname!'\r\n            : dupeLoc ? errorText + 'Coordinates match existing waypoint!' : errorText + 'Unknown error...'\r\n\r\n      setErrorText(errorText);\r\n      setSnackbar(true);\r\n\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Grid container>\r\n        <Grid item xs style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n          <div style={{ padding: \"10px\" }}>\r\n            <TextField id=\"location-nickname-input\" label=\"Nickname for Location\" onChange={(e) => setlocNickname(e.target.value)} />\r\n            <Button variant=\"contained\" color=\"secondary\" onClick={() => addLocation()} style={{ marginLeft: \"20px\" }}>Add From Marker</Button>\r\n          </div>\r\n          <div style={{maxHeight: \"50vh\", overflow: 'auto'}}>\r\n            <CheckboxList style={{ maxHeight: \"initial\", height: \"auto\", overflow: \"scroll\" }} items={locations} handleToggle={handleToggle(setLocsChecked)} checked={locsChecked} deletable={true} handleDelete={handleDelete(setLocations)} />\r\n          </div>\r\n          <div style={{ padding: \"10px\", marginTop: \"auto\" }}>\r\n            <TextField\r\n              style={{ minWidth: \"75%\" }}\r\n              variant=\"outlined\"\r\n              label=\"Select Depot\"\r\n              select\r\n              size='small'\r\n              SelectProps={{\r\n                value: locsChecked.indexOf(depot),\r\n                onChange: (event) => setDepot(locsChecked[event.target.value])\r\n              }}\r\n            >\r\n              {locsChecked.map((loc, index) => {\r\n                return <MenuItem value={index}>{loc.toString()}</MenuItem>\r\n              })}\r\n            </TextField>\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs>\r\n          <MapBox height=\"60vh\" width=\"70vw\" mapState={mapState} />\r\n        </Grid>\r\n      </Grid>\r\n    </div >\r\n  )\r\n}\r\n","import React from \"react\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport { Draggable } from \"react-beautiful-dnd\";\r\n\r\nexport default function ListItemCustom({ itemObject, index }) {\r\n  return (\r\n    <Draggable draggableId={itemObject.id} key={itemObject.id} index={index}>\r\n      {(provided) => (\r\n        <div ref={provided.innerRef} {...provided.draggableProps} {...provided.dragHandleProps}>\r\n          <ListItem\r\n            key={itemObject.id}\r\n            role={undefined}\r\n            dense\r\n            button\r\n            ContainerComponent=\"li\"\r\n          >\r\n            <ListItemText\r\n              primary={`${itemObject.content}`}\r\n            />\r\n          </ListItem>\r\n        </div>\r\n      )}\r\n    </Draggable>\r\n  );\r\n};\r\n\r\n","import React from \"react\";\r\nimport { Droppable } from \"react-beautiful-dnd\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItemCustom from \"./ListItemCustom\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\n\r\nexport default function Column({ column }) {\r\n  return (\r\n    <div\r\n      style={{\r\n        backgroundColor: \"#5f2c82\",\r\n        margin: 10,\r\n        padding: 20,\r\n        color: \"white\",\r\n        borderRadius: \"13px\",\r\n      }}\r\n    >\r\n      <Typography variant={\"h7\"}>{column.id}</Typography>\r\n      <Droppable droppableId={column.id}>\r\n        {(provided) => (\r\n          <div ref={provided.innerRef} {...provided.droppableProps}>\r\n            <List>\r\n              {column.list.map((itemObject, index) => {\r\n                return <ListItemCustom index={index} itemObject={itemObject} />;\r\n              })}\r\n              {provided.placeholder}\r\n            </List>\r\n          </div>\r\n        )}\r\n      </Droppable>\r\n    </div>\r\n  );\r\n};\r\n","// The code in this file and folder are modified from https://codesandbox.io/s/react-material-ui-drag-and-drop-trello-clone-2-lists-7q46h\r\n\r\nimport React from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n//import makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport { DragDropContext } from \"react-beautiful-dnd\";\r\nimport Column from \"./Column\";\r\n\r\n// const useStyles = makeStyles((theme) => ({\r\n\r\n// }));\r\n\r\nexport default function DragDropListOfLists({ stateUpdater, state }) {\r\n  //const classes = useStyles();\r\n\r\n  /*\r\n    TODO: It's really important how you structure your data!!!\r\n      each column has to have a unique id, each item has to have a unique id and ideally consecutive else funky things happen\r\n      each droppable has to have a unique id, each draggable also - cannot stress this enough because that is the only way\r\n      the framework knows how what went from which list\r\n    */\r\n  // const initialColumns = {\r\n  //   todo: {\r\n  //     id: \"todo\",\r\n  //     list: [\r\n  //       { id: \"1\", text: \"text1\" },\r\n  //       { id: \"2\", text: \"text2\" },\r\n  //       { id: \"3\", text: \"text3\" }\r\n  //     ]\r\n  //   },\r\n  //   doing: {\r\n  //     id: \"doing\",\r\n  //     list: [\r\n  //       { id: \"4\", text: \"text4\" },\r\n  //       { id: \"5\", text: \"text5\" },\r\n  //       { id: \"6\", text: \"text6\" }\r\n  //     ]\r\n  //   },\r\n  //   done: {\r\n  //     id: \"done\",\r\n  //     list: []\r\n  //   }\r\n  // };\r\n\r\n  const onDragEnd = ({ source, destination }) => {\r\n    // Make sure we have a valid destination\r\n    if (destination === undefined || destination === null) return null;\r\n\r\n    // Make sure we're actually moving the item\r\n    if (\r\n      source.droppableId === destination.droppableId &&\r\n      destination.index === source.index\r\n    )\r\n      return null;\r\n\r\n    // Set start and end variables\r\n    const start = state[source.droppableId];\r\n    const end = state[destination.droppableId];\r\n\r\n    // If start is the same as end, we're in the same column\r\n    if (start === end) {\r\n      // Move the item within the list\r\n      // Start by making a new list without the dragged item\r\n      const newList = start.list.filter((_, idx) => idx !== source.index);\r\n\r\n      // Then insert the item at the right location\r\n      newList.splice(destination.index, 0, start.list[source.index]);\r\n\r\n      // Then create a new copy of the column object\r\n      const newCol = {...start,\r\n        id: start.id,\r\n        list: newList\r\n      };\r\n\r\n      // Update the state\r\n      stateUpdater((state) => ({ ...state, [newCol.id]: newCol }));\r\n      return null;\r\n    } else {\r\n      // If start is different from end, we need to update multiple columns\r\n      // Filter the start list like before\r\n      const newStartList = start.list.filter((_, idx) => idx !== source.index);\r\n\r\n      // Create a new start column\r\n      const newStartCol = {...start,\r\n        id: start.id,\r\n        list: newStartList\r\n      };\r\n\r\n      // Make a new end list array\r\n      const newEndList = end.list;\r\n\r\n      // Insert the item into the end list\r\n      newEndList.splice(destination.index, 0, start.list[source.index]);\r\n\r\n      // Create a new end column\r\n      const newEndCol = {...end,\r\n        id: end.id,\r\n        list: newEndList\r\n      };\r\n\r\n      // Update the state\r\n      stateUpdater((state) => ({\r\n        ...state,\r\n        [newStartCol.id]: newStartCol,\r\n        [newEndCol.id]: newEndCol\r\n      }));\r\n      return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <DragDropContext onDragEnd={onDragEnd}>\r\n      <Grid container direction={\"row\"} justifyContent={\"center\"}>\r\n        {Object.values(state).map((column) => {\r\n          return (\r\n            <Grid item>\r\n              <Column column={column} key={column.id} />\r\n            </Grid>\r\n          );\r\n        })}\r\n      </Grid>\r\n    </DragDropContext>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport '../App.css';\r\nimport { Grid } from \"@material-ui/core\";\r\nimport CheckboxList from '../components/CheckboxList.js';\r\nimport DragDropListOfLists from '../components/DnDListofLists/DnDListofLists';\r\nimport { getExampleCars } from '../Classes';\r\n\r\nexport default function AssignVehicles({ locsChecked, handleToggle, vehiLocs, setVehiLocs, depot, vehiChecked, setVehiChecked }) {\r\n    //vehicle page constants\r\n    const cars = getExampleCars();\r\n\r\n    React.useEffect(() => {\r\n        const depotPos = locsChecked.indexOf(depot);\r\n        const noDepotLocs = locsChecked.slice(0, depotPos).concat(locsChecked.slice(depotPos + 1));\r\n        setVehiLocs(initVehiLocs(vehiChecked, noDepotLocs));\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [vehiChecked, locsChecked]);\r\n\r\n    return (\r\n        <div>\r\n            <Grid container>\r\n                <Grid item xs style={{ maxHeight: \"70vh\", overflow: 'auto' }}>\r\n                    <CheckboxList items={cars} handleToggle={handleToggle(setVehiChecked)} checked={vehiChecked} />\r\n                </Grid>\r\n                <Grid item xs={9}>\r\n                    <div style={{ textAlign: 'center' }}>\r\n                        <p>Drag and drop the locations between your selected cars. Rearrange the locations in the order you would like the cars to visit.</p>\r\n                        <p><b>Note: All vehicles will start and finish at the depot, which is currently set to {depot.toString()}.</b></p>\r\n                    </div>\r\n                    <DragDropListOfLists stateUpdater={setVehiLocs} state={vehiLocs} />\r\n                </Grid>\r\n            </Grid>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst splitToChunks = (array, parts) => {\r\n    let result = [];\r\n    for (let i = parts; i > 0; i--) {\r\n        result.push(array.splice(0, Math.ceil(array.length / i)));\r\n    }\r\n    return result;\r\n};\r\n\r\nconst initVehiLocs = (vehicles, locs) => {\r\n    let chunkedLocs = splitToChunks(locs.map((loc, idx) => ({ id: idx.toString(), content: loc })), vehicles.length);\r\n    let result = vehicles.reduce((obj, veh, idx) => {\r\n        obj[veh.toString()] = {\r\n            id: veh.toString(), vehicle: veh, list: chunkedLocs[idx]\r\n        };\r\n        console.log(obj[veh.toString()]);\r\n        return obj;\r\n    }\r\n        , {}\r\n    )\r\n    return result;\r\n};\r\n","import React from 'react';\r\nimport '../App.css';\r\nimport { DateTimePicker } from \"@material-ui/pickers\";\r\nimport { TextField, Grid, RadioGroup, FormControlLabel, Radio } from \"@material-ui/core\";\r\nimport MapBox from '../components/MapBox.js';\r\nimport { optimise, tourToVehicleTrip } from '../Optimise';\r\nimport { Trip } from \"../Classes\";\r\n\r\nexport default function ExtraDetails({ vehiLocs, locsChecked, vehiChecked, depot, setTrip, currentTrip }) {\r\n    //details page constants\r\n    const [selectedDate, handleDateChange] = React.useState(new Date());\r\n    const [notes, setNotes] = React.useState(\"\");\r\n\r\n    // list of locations, with the depot at index 0\r\n    const depotPos = locsChecked.indexOf(depot);\r\n    const noDepot = locsChecked.slice(0, depotPos).concat(locsChecked.slice(depotPos + 1));\r\n    const depotAndLocs = [depot, ...noDepot];\r\n\r\n    const locationIndexMapping = depotAndLocs.reduce((obj, loc, index) => {\r\n        obj[index] = loc;\r\n        return obj;\r\n    }, {})\r\n\r\n    // tours = [list of tours]\r\n    // tour = {\r\n    //     vehicleId: JSONified vehicle\r\n    //     stops: [{location:{index:0}}, {location:{index:1}}, {location:{index:0}}]\r\n    // }\r\n    const vehiLoctoTour = (vehiLoc) => {\r\n        console.log(vehiLoc);\r\n        let tour = { vehicleId: JSON.stringify(vehiLoc.vehicle), stops: [{ location: { index: 0 } }] };\r\n        vehiLoc.list.forEach(loc => tour[\"stops\"].push({ location: { index: depotAndLocs.indexOf(loc.content) } }))\r\n        tour[\"stops\"].push({ location: { index: 0 } });\r\n        return tour;\r\n    };\r\n\r\n    const tours = Object.keys(vehiLocs).reduce((prev, key) => {\r\n        if (vehiLocs[key].list.length !== 0) {\r\n            return [...prev, vehiLoctoTour(vehiLocs[key])]\r\n        } else {\r\n            return prev\r\n        }\r\n    }, [])\r\n\r\n    const [tripMode, setTripMode] = React.useState(\"Normal\");\r\n    const [mapState, setMapState] = React.useState({});\r\n\r\n    React.useEffect(() => {\r\n        getUnoptimised(selectedDate, tours, locationIndexMapping, notes).then(function(trip) { \r\n            setTrip(trip); \r\n            setMapState(trip.getMapState()); \r\n            console.log(trip); });\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [])\r\n\r\n    React.useEffect(() => {\r\n        const newTrip = {...currentTrip, date: selectedDate, notes: notes };\r\n        setTrip(newTrip);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [notes, selectedDate])\r\n\r\n    const handleRadio = (event) => {\r\n        if (event.target.value === \"Optimised\") {\r\n            optimise(selectedDate, vehiChecked, noDepot, depot, notes).then(function(trip) { \r\n                setTrip(trip); \r\n                setMapState(trip.getMapState()); \r\n                setTripMode(\"Optimised\"); \r\n                console.log(trip); \r\n            });\r\n        } else {\r\n            getUnoptimised(selectedDate, tours, locationIndexMapping, notes).then(function(trip) { \r\n                setTrip(trip); \r\n                setMapState(trip.getMapState()); \r\n                setTripMode(\"Normal\"); \r\n                console.log(trip); \r\n            });\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Grid container>\r\n                <Grid item xs style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n                    <div style={{ padding: \"10px\" }}>\r\n                        <DateTimePicker\r\n                            autoOk\r\n                            ampm={false}\r\n                            disablePast\r\n                            value={selectedDate}\r\n                            onChange={handleDateChange}\r\n                            label=\"Date/Time\"\r\n                            showTodayButton\r\n                        />\r\n                    </div>\r\n\r\n                    <div style={{ padding: \"10px\" }}>\r\n                        <RadioGroup row value={tripMode} label=\"Select Trip Mode\">\r\n                            <FormControlLabel checked={tripMode === \"Normal\"} onChange={handleRadio} value=\"Normal\" control={<Radio />} label=\"Normal\" />\r\n                            <FormControlLabel checked={tripMode === \"Optimised\"} onChange={handleRadio} value=\"Optimised\" control={<Radio />} label=\"Optimised\" />\r\n                        </RadioGroup>\r\n                    </div>\r\n\r\n                    <div style={{ padding: \"10px\" }}>\r\n                        <TextField\r\n                            id=\"outlined-multiline-static\"\r\n                            label=\"Extra Notes\"\r\n                            multiline\r\n                            variant=\"outlined\"\r\n                            onChange={(event) => setNotes(event.target.value)}\r\n                        />\r\n                    </div>\r\n\r\n                </Grid>\r\n                <Grid item xs>\r\n                    <MapBox height=\"60vh\" width=\"70vw\" mapState={mapState} />\r\n                </Grid>\r\n            </Grid>\r\n        </div>\r\n    )\r\n}\r\n\r\nasync function getUnoptimised(selectedDate, tours, locationIndexMapping, notes) {\r\n    let vehicleTrips = await Promise.all(tours.map(async tour => await tourToVehicleTrip(tour, locationIndexMapping)));\r\n    return new Trip(selectedDate, vehicleTrips, notes);\r\n}","import './App.css';\r\nimport React from 'react';\r\nimport { Button, Stepper, Step, StepLabel } from \"@material-ui/core\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Trips from './Trips';\r\nimport '@mapbox/mapbox-gl-geocoder/dist/mapbox-gl-geocoder.css';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\n//import { database } from './App';\r\n\r\nimport SelectWaypoints from './AddTrip/SelectWaypoints';\r\nimport AssignVehicles from './AddTrip/AssignVehicles';\r\nimport ExtraDetails from './AddTrip/ExtraDetails';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  // root: {\r\n  //   width: '100%',\r\n  // },\r\n  // button: {\r\n  //   marginRight: theme.spacing(1),\r\n  // },\r\n  // instructions: {\r\n  //   marginTop: theme.spacing(1),\r\n  //   marginBottom: theme.spacing(1),\r\n  // },\r\n}));\r\n\r\nexport default function AddTrip(props) {\r\n  // whole page constants\r\n  const classes = useStyles();\r\n  const steps = ['Select Waypoints', 'Assign Vehicles', 'Extra Details'];\r\n  const [activeStep, setActiveStep] = React.useState(0);\r\n  const [snackbarOpen, setSnackbar] = React.useState(false);\r\n  const [errorText, setErrorText] = React.useState('');\r\n\r\n  // Interesting state constants\r\n  const [locsChecked, setLocsChecked] = React.useState([]);\r\n  const [vehiChecked, setVehiChecked] = React.useState([]);\r\n  const [vehiLocs, setVehiLocs] = React.useState({});\r\n  const [depot, setDepot] = React.useState(null);\r\n  const [trip, setTrip] = React.useState(null);\r\n\r\n  // Setting depot if previously selected isn't available anymore\r\n  React.useEffect(() => {\r\n    if (locsChecked.length === 0) {\r\n      setDepot(null)\r\n    } else if (locsChecked.indexOf(depot) === -1) {\r\n      setDepot(locsChecked[0])\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [locsChecked]);\r\n\r\n  const handleNext = () => {\r\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\r\n  };\r\n\r\n  const handleBack = () => {\r\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\r\n  };\r\n\r\n  const checkLocsExist = () => {\r\n    setErrorText(\"More than 1 location required for a trip!\");\r\n    setSnackbar(true)\r\n  }\r\n  const finish = () => {\r\n    props.addToDatabase('trips/', JSON.stringify(trip));\r\n    props.pageUpdater(<Trips pageUpdater={props.pageUpdater} addToDatabase={props.addToDatabase} user={props.user} />)\r\n  }\r\n\r\n  const getStepContent = (step) => {\r\n    switch (step) {\r\n      case 0: // Waypoints\r\n        return (<SelectWaypoints\r\n          locsChecked={locsChecked}\r\n          setLocsChecked={setLocsChecked}\r\n          handleToggle={handleToggle}\r\n          handleDelete={handleDelete}\r\n          setDepot={setDepot}\r\n          depot={depot}\r\n          setSnackbar={setSnackbar}\r\n          setErrorText={setErrorText}\r\n        />);\r\n\r\n      case 1: // Vehicles\r\n        return (<AssignVehicles\r\n          locsChecked={locsChecked}\r\n          handleToggle={handleToggle}\r\n          vehiLocs={vehiLocs}\r\n          setVehiLocs={setVehiLocs}\r\n          depot={depot}\r\n          vehiChecked={vehiChecked}\r\n          setVehiChecked={setVehiChecked}\r\n        />);\r\n\r\n      case 2: // Extra Details\r\n        return (<ExtraDetails\r\n          vehiLocs={vehiLocs}\r\n          depot={depot}\r\n          locsChecked={locsChecked}\r\n          vehiChecked={vehiChecked}\r\n          setTrip={setTrip}\r\n          currentTrip={trip}\r\n        />);\r\n\r\n      default:\r\n        return 'Unknown step';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div className=\"row\">\r\n        <div className=\"divBox\">\r\n          <h2>New Trip</h2>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"row\">\r\n        <div className={`classes.instructions divBox`} style={{ width: \"100%\" }}>{getStepContent(activeStep)}</div>\r\n      </div>\r\n\r\n      <div className=\"row\">\r\n        <div className=\"divBox\" style={{ display: \"inline\" }}>\r\n          <Button disabled={activeStep === 0} onClick={handleBack} className={classes.button}>\r\n            Back\r\n          </Button>\r\n\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={locsChecked.length <= 1 && activeStep === 0 ? checkLocsExist : activeStep === steps.length - 1 ? finish : handleNext}\r\n            className={classes.button}\r\n          >\r\n            {activeStep === steps.length - 1 ? 'Finish' : 'Next'}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"row\">\r\n        <div className=\"divBox\" style={{ width: \"100%\" }}>\r\n          <Stepper activeStep={activeStep}>\r\n            {steps.map((label, index) => {\r\n              const stepProps = {};\r\n              const labelProps = {};\r\n              return (\r\n                <Step key={label} {...stepProps}>\r\n                  <StepLabel {...labelProps}>{label}</StepLabel>\r\n                </Step>\r\n              );\r\n            })}\r\n          </Stepper>\r\n        </div>\r\n      </div>\r\n\r\n      <Snackbar open={snackbarOpen} autoHideDuration={6000} onClose={() => setSnackbar(false)}>\r\n        <MuiAlert elevation={6} variant=\"filled\" severity=\"warning\" onClose={() => setSnackbar(false)}>\r\n          {errorText}\r\n        </MuiAlert>\r\n      </Snackbar>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst handleToggle = (updater) => (checked) => (value) => () => {\r\n  const currentIndex = checked.indexOf(value);\r\n  const newChecked = [...checked];\r\n\r\n  if (currentIndex === -1) {\r\n    newChecked.push(value);\r\n  } else {\r\n    newChecked.splice(currentIndex, 1);\r\n  }\r\n\r\n  updater(newChecked);\r\n};\r\n\r\nconst handleDelete = (updater) => (items) => (item) => () => {\r\n  const currentIndex = items.indexOf(item);\r\n  const newItems = [...items];\r\n\r\n  newItems.splice(currentIndex, 1);\r\n\r\n  console.log(newItems);\r\n  updater(newItems);\r\n};","import '../App.css';\nimport React from 'react';\nimport {ExpandMore, Event, Timer, AvTimer, Straighten, LocalShipping, Eco, Room, Map, Navigation, Store} from '@material-ui/icons';\nimport {Button, Accordion, AccordionActions, AccordionDetails, AccordionSummary, Divider, \n  Typography, Chip, Tooltip, Dialog, DialogTitle, DialogActions} from \"@material-ui/core\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport { database } from '../App';\n\nconst useStyles = makeStyles((theme) => ({\n  Accordion: {\n    \"&.MuiAccordion-root:before\": {\n      backgroundColor: \"rgba(255, 255, 255, 0)\",\n    },\n    maxWidth: \"100%\"\n  },\n  wrapChipRoot: { height: '100%', display: 'flex', flexDirection: 'column' }, \n  wrapChipLabel: { marginBottom: 5, marginTop: 5, overflowWrap: 'break-word', whiteSpace: 'normal', textOverflow: 'clip' }\n}));\n\nconst handleViewMap = (event, modalOpener, setMapState, mapState) => {\n  setMapState(mapState);\n  modalOpener(true);\n  event.stopPropagation()\n}\n\nexport default function TripAccordian(props) {\n  const trip = props.trip;\n  const vehicleTrips = [];\n  for (let i = 0; i < trip.vehicleTrips.length; i++) {\n    vehicleTrips.push(<VehicleAccordian vehicleTrip={trip.vehicleTrips[i]} modalOpener={props.modalOpener} setMapState={props.setMapState}/>);\n    vehicleTrips.push(<div style={{margin: 7}}></div>);\n  };\n\n  const [dialogState, setDialogState] = React.useState(false);\n  const handleClickDeleteButton = () => {\n    setDialogState(true);\n  };\n  const handleDialogClose = () => {\n    setDialogState(false);\n  };\n  const handleDelete = () => {\n    database.ref('trips/' + props.user.uid + '/' + trip.dbKey).remove(); \n    handleDialogClose();\n  }\n  const classes = useStyles();\n\n  return (\n    <Accordion className=\"roundedCorners\" classes={{root: classes.Accordion}} expanded={props.expanded === props.id} onChange={props.changeHandler(props.id)}>\n      <AccordionSummary expandIcon={<ExpandMore />} style={{marginLeft: 3}}>\n        <div className=\"row\" style={{width: \"100%\", alignItems: \"center\"}}>\n          <div style={{display: \"flex\", flexDirection: \"column\", marginRight: \"auto\", paddingRight: 15}}>\n            <div className=\"row\"><Chip variant=\"outlined\" color='primary' icon={<Event />} label={<Typography variant=\"h6\">{trip.date.getDate() + \"/\" + (trip.date.getMonth()+1) + \"/\" + trip.date.getFullYear()}</Typography>} /></div>\n            {trip.notes ? <div className=\"row\" style={{margin: 0, padding: 0}}><Chip classes={{ root: classes.wrapChipRoot, label: classes.wrapChipLabel, }} variant=\"outlined\" color='primary' label={<Typography variant=\"body2\"><b>Notes:</b> {trip.notes}</Typography>} /></div> : null}\n            <div className=\"row\">\n              <Tooltip title=\"Consecutive Duration\"><Chip icon={<Timer />} label={\"Duration: \" + (trip.consecutiveDuration < 121 ? trip.consecutiveDuration + \" minutes\" : Math.round((trip.consecutiveDuration/60) * 10) / 10 + \" hours\")}/></Tooltip>\n              <Tooltip title=\"Total Individual Driving Minutes\"><Chip icon={<AvTimer />} label={\"Aggregate: \" + (trip.consecutiveDuration < 121 ? trip.totalDuration + \" minutes\" : Math.round((trip.totalDuration/60) * 10) / 10 + \" hours\")} /></Tooltip>\n              <Tooltip title=\"Total Distance\"><Chip icon={<Straighten />} label={trip.distance + \"km\"} /></Tooltip>\n              <Tooltip title=\"Depot\"><Chip icon={<Store />} label={trip.depot.nickname} /></Tooltip>\n              <Tooltip title=\"Number of Jobs\"><Chip icon={<Room />} label={trip.vehicleTrips.reduce(((acc, v) => (v.tripLegs.length-1) + acc), 0) + \" jobs\"} /></Tooltip>\n              <Tooltip title=\"Number of Vehicles Used\"><Chip icon={<LocalShipping />} label={trip.vehicleTrips.length + \" vehicle\" + (trip.vehicleTrips.length === 1 ? \"\" : \"s\")} /></Tooltip>\n              <Tooltip title={<> Amount of CO<sub>2</sub> Emitted </>}><Chip icon={<Eco />} label={trip.emissions < 1000 ? trip.emissions + \"g of CO2\" : Math.round((trip.emissions/1000) * 10) / 10 + \"kgs of CO2\"} /></Tooltip>\n            </div>\n          </div>\n          <div style={{display: 'flex', flexDirection: \"row\", gap: 5}}>\n            <Button variant=\"outlined\" color=\"primary\" startIcon={<Map />} onClick={event => handleViewMap(\n              event, props.modalOpener, props.setMapState, trip.getMapState())}>\n              Show on Map\n            </Button>\n          </div>\n        </div>\n      </AccordionSummary>\n      <AccordionDetails className=\"innerAccordian\">\n        <Typography style={{marginBottom: 5}}><b>Vehicles:</b></Typography>\n        {vehicleTrips}\n      </AccordionDetails>\n      <Divider />\n      <AccordionActions>\n        <Button size=\"small\" color=\"secondary\" onClick={() => handleClickDeleteButton()}>Delete Trip</Button>\n      </AccordionActions>\n      <Dialog open={dialogState} onClose={handleDialogClose}>\n        <DialogTitle >Are you sure you want to delete this trip?</DialogTitle>\n        <DialogActions>\n          <Button onClick={handleDialogClose} color=\"primary\">\n            Cancel\n          </Button>\n          <Button onClick={handleDelete} color=\"secondary\" autoFocus>\n            Delete\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Accordion>\n  )\n}\n\nfunction VehicleAccordian(props) {\n  const classes = useStyles();\n  const vehicleTrip = props.vehicleTrip;\n  const vehicle = vehicleTrip.vehicle;\n  const legs = []\n  for (let i = 0; i < vehicleTrip.tripLegs.length; i++) {\n    legs.push(<DisplayLeg leg={vehicleTrip.tripLegs[i]} modalOpener={props.modalOpener} setMapState={props.setMapState}/>)\n  };\n  return (\n    <Accordion className={`roundedCorners fillWidth`} classes={{root: classes.Accordion}}>\n      <AccordionSummary expandIcon={<ExpandMore />} style={{minHeight: \"1px !important\"}}>\n        <div className=\"row\" style={{width: \"100%\", alignItems: \"center\"}}>\n          <div style={{display: \"flex\", flexDirection: \"column\", marginRight: \"auto\", paddingRight: 15}}>\n            <div className=\"row\" style={{marginBottom: 0, paddingTop: 0}}>\n              <Tooltip title=\"Vehicle Used\"><div className=\"row\"><Chip variant=\"outlined\" color='primary' classes={{ root: classes.wrapChipRoot, label: classes.wrapChipLabel, }} label={<b>{vehicle.toString()}</b>}/></div></Tooltip>\n            </div>\n            <div className=\"row\" style={{paddingTop: 0}}>\n              <Tooltip title=\"Duration\"><Chip icon={<Timer />} label={vehicleTrip.vehicleDuration < 121 ? vehicleTrip.vehicleDuration + \" minutes\" : Math.round((vehicleTrip.vehicleDuration/60) * 10) / 10 + \" hours\"}/></Tooltip>\n              <Tooltip title=\"Distance\"><Chip icon={<Straighten />} label={vehicleTrip.vehicleDistance + \"km\"} /></Tooltip>\n              <Tooltip title=\"Number of Jobs\"><Chip icon={<Room />} label={(vehicleTrip.tripLegs.length-1) + \" jobs\"} /></Tooltip>\n              <Tooltip title={<> Amount of CO<sub>2</sub> Emitted </>}><Chip icon={<Eco />} label={vehicleTrip.vehicleEmissions < 1000 ? vehicleTrip.vehicleEmissions + \"g of CO2\" : Math.round((vehicleTrip.vehicleEmissions/1000) * 10) / 10 + \"kgs of CO2\"} /></Tooltip>\n            </div>\n          </div>\n          <div style={{display: 'flex', flexDirection: \"row\", gap: 5}}>\n            <Button variant=\"outlined\" color=\"primary\" startIcon={<Map />} onClick={event => handleViewMap(\n              event, props.modalOpener, props.setMapState, vehicleTrip.getMapState())}>\n              Show on Map\n            </Button>\n          </div>\n        </div>\n      </AccordionSummary>\n      <AccordionDetails style={{display: \"block\"}}>\n      <Typography style={{marginBottom: 5}}><b>Legs:</b></Typography>\n        {legs}\n      </AccordionDetails>\n    </Accordion>\n  );\n}\n\nfunction DisplayLeg(props) {\n  const classes = useStyles();\n  const origin_lat = props.leg.startLocation.lat;\n  const origin_long = props.leg.startLocation.long;\n  const dest_lat = props.leg.endLocation.lat;\n  const dest_long = props.leg.endLocation.long;\n  const navURL = \"https://www.google.com/maps/dir/?api=1&travelmode=driving&origin=\" + \n    origin_lat + \",\" + origin_long + \"&destination=\" + dest_lat + \",\" + dest_long\n  return (\n    <div className=\"divBox\" style={{marginBottom: 10, width: \"calc(100% - 20px)\"}}>\n      <div style={{display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\", gap: 5}}>\n        <div style={{marginRight: \"auto\", marginLeft: 0}}>\n          <div className=\"row\" style={{margin: 0, padding: 0}}><Tooltip title=\"Waypoints\" style={{margin: 4, marginLeft: 0}}><Chip classes={{ root: classes.wrapChipRoot, label: classes.wrapChipLabel, }} variant=\"outlined\" color='primary' label={<Typography variant=\"body2\">{props.leg.startLocation.nickname} to {props.leg.endLocation.nickname}</Typography>} /></Tooltip></div>\n          <Tooltip title=\"Duration\" style={{margin: 4, marginLeft: 0}}><Chip icon={<Timer />} label={props.leg.duration < 121 ? props.leg.duration + \" minutes\" : Math.round((props.leg.duration/60) * 10) / 10 + \" hours\"}/></Tooltip>\n          <Tooltip title=\"Distance\" style={{margin: 4, marginLeft: 0}}><Chip icon={<Straighten />} label={props.leg.distance + \"km\"} /></Tooltip>\n          <Tooltip title={<> Amount of CO<sub>2</sub> Emitted </>} style={{margin: 4, marginLeft: 0}}><Chip icon={<Eco />} label={props.leg.legEmissions < 1000 ? props.leg.legEmissions + \"g of CO2\" : Math.round((props.leg.legEmissions/1000) * 10) / 10 + \"kgs of CO2\"} /></Tooltip>\n        </div>\n        <div style={{display: 'flex', flexDirection: \"row\", gap: 5}}>\n          <Button variant=\"outlined\" size=\"small\" color=\"primary\" startIcon={<Map />} onClick={event => handleViewMap(\n              event, props.modalOpener, props.setMapState, props.leg.getMapState()\n              )}\n          >\n            Show on Map\n          </Button>\n          <Button target=\"_blank\" href={navURL} color=\"primary\" variant=\"outlined\" size=\"small\" startIcon={<Navigation />}>Navigate</Button>\n        </div>\n        \n      </div>\n    </div>\n  )\n}\n","import './App.css';\nimport { database } from './App';\nimport React from 'react';\nimport AddTrip from './AddTrip';\nimport {Button, MenuItem, TextField, Typography, LinearProgress, Grow, Tooltip, Backdrop, IconButton} from \"@material-ui/core\";\nimport {Cancel} from '@material-ui/icons';\nimport TripAccordian from './components/TripAccordian';\nimport { getExampleOptimisedTrip, getExampleOptimisedTrip2, getExampleOptimisedTrip3, Trip} from './Classes';\nimport MapBox from './components/MapBox.js';\n\nfunction filterTrips(filter, allTripsList, currentTripsList, searchText) {\n  if (searchText) {\n    allTripsList = allTripsList.filter((trip) => (\n      trip.date.getDate() + \"/\" + (trip.date.getMonth()+1) + \"/\" + trip.date.getFullYear() + \" \" + \n      trip.notes + \" \" + \n      JSON.stringify(trip)).toLowerCase().includes(searchText.toLowerCase()));\n  }\n  if (filter[0] !== 0){\n    return allTripsList.filter((trip) => (\n      new Date(trip.date.toDateString()) < (new Date(new Date().toDateString())) && filter[0] === 1 ? true : \n      (trip.date.toDateString()) === (new Date().toDateString()) && filter[0] === 2 ? true : \n      (new Date(trip.date.toDateString()) > (new Date(new Date().toDateString())) && filter[0] === 3) ? true : \n      false)\n    );\n  }\n  if (filter[0] === 0){\n    return allTripsList;\n  }\n  else {\n    return currentTripsList;\n  }\n}\n\n\nexport default function Trips(props) {\n  const [filter, setFilter] = React.useState([0, true]);\n  const [searchText, search] = React.useState(\"\");\n  const [currentTripsList, setTrips] = React.useState([]);\n  const [allTripsList, setAllTrips] = React.useState([]);\n  const [stillLoading, setStillLoading] = React.useState(true);\n  const [showTrips, setShowTrips] = React.useState(false);\n  const [modalState, setModalOpen] = React.useState(false);\n  const [mapIsLoaded, setMapIsLoaded] = React.useState(false);\n  if (modalState && !mapIsLoaded) {setMapIsLoaded(true)}; // only load map component if already been requested\n\n  // Map state:\n  const [mapState, setMapState] = React.useState({});\n\n  const [expanded, setExpanded] = React.useState(false);\n  const handleChange = (panel) => (event, isExpanded) => {\n    setExpanded(isExpanded ? panel : false);\n  };\n\n  React.useEffect(() =>\n    database.ref(\"trips/\" + props.user.uid).on(\"value\", snapshot => {\n      let allTrips = [];\n      try {\n        if (snapshot) {\n        snapshot.forEach(snap => {\n            let i = new Trip(); \n            i.objectToInstance(JSON.parse(snap.val().data), snap.key);\n            allTrips.push(i);\n        }\n        )\n      };\n      }\n      catch (e){\n        if (!(e instanceof ReferenceError)) {throw e}\n        else {console.log(\"Caught:\" + e)};\n      }\n      setAllTrips(allTrips);\n      setTrips(filterTrips(filter, allTrips, currentTripsList));\n      setFilter([filter[0], false]);\n      setExpanded(false);\n      setStillLoading(false);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, (err) => console.log(err)), [])\n\n  const addTestTrips = () => {\n    const errorHandler = (error) => {\n      console.log(error);\n      alert(\"There was an error retrieving the navigation data. Either your are offline or have made too many requests in a short period. Check your internet connection and try again in a few minutes.\\n\" + error);\n    }\n    // Test the trip optimiser\n    getExampleOptimisedTrip().then(function(trip) { props.addToDatabase('trips/', JSON.stringify(trip)); console.log(trip) }, errorHandler);\n    getExampleOptimisedTrip2().then(function(trip) { props.addToDatabase('trips/', JSON.stringify(trip)); console.log(trip) }, errorHandler);\n    getExampleOptimisedTrip3().then(function(trip) { props.addToDatabase('trips/', JSON.stringify(trip)); console.log(trip) }, errorHandler);\n    alert(\"Takes about 30 seconds to add (10 seconds per trip)\")\n  }\n  \n  allTripsList.sort((a, b) => new Date(b.date) - new Date(a.date));\n  if (filter[1]) {\n    var trips = filterTrips(filter, allTripsList, currentTripsList, searchText);\n    setTrips(trips);\n    setFilter([filter[0], false]);\n  }\n \n  let tripComponents = [];\n  if (stillLoading) {\n    tripComponents = <LinearProgress className='progressBar'/>\n  }\n  else {\n    for (let i = 0; i < currentTripsList.length; i++) {\n      tripComponents.push(\n        <Grow in={showTrips} {...(showTrips ? { timeout: Math.min(200 + (i*500), 5000) } : {})} >\n          <div>\n            <TripAccordian trip={currentTripsList[i]} id={i} changeHandler={handleChange} expanded={expanded} user={props.user} \n              modalOpener={setModalOpen} setMapState={setMapState}/>\n            <div style={{margin: 4}}></div>\n          </div>\n        </Grow>);\n    };\n    if (tripComponents.length === 0){\n      tripComponents = <Typography variant=\"h6\">No Trips to Show</Typography>;\n    }\n    if (!showTrips) {setShowTrips(true)}\n  }\n  \n  return (\n    <>\n    <div className=\"row\">\n      <div className=\"divBox\" style={{minHeight: 40, marginRight: \"auto\"}}>\n          <Button variant=\"contained\" color=\"secondary\" onClick={() => props.pageUpdater(<AddTrip pageUpdater={props.pageUpdater} addToDatabase={props.addToDatabase} user={props.user}/>)}>\n            Create Trip\n          </Button>\n        </div>\n\n        <div className=\"divBox\">\n          <Tooltip title=\"Search by date, vehicles, waypoints, notes, roads, stats, etc.\">\n            <TextField label=\"Search\" type=\"search\" variant=\"outlined\" size=\"small\" onChange={(event) => {search(event.target.value); setFilter([filter[0], true])}}/>\n          </Tooltip>\n        </div>    \n        <div className=\"divBox\" style={{minWidth: \"15%\"}}>\n          <TextField\n            label=\"Filter\"\n            variant=\"outlined\"\n            select\n            size='small'\n            SelectProps={{ value: filter[0], onChange: (event) => {setFilter([event.target.value, true])}}}\n          >\n            <MenuItem value={0}>All</MenuItem>\n            <MenuItem value={1}>Past</MenuItem>\n            <MenuItem value={2}>Today</MenuItem>\n            <MenuItem value={3}>Future</MenuItem>\n          </TextField> \n        </div>     \n      </div>\n\n      <div className=\"row\">\n        <div className={`divBox tripList`}>\n            {tripComponents}\n        </div>\n      </div>\n\n      {mapIsLoaded ? // delay the initalisation of the Map component until first requested\n      <div style={{position: \"fixed\", zIndex: 1, top: 0, left: 0, height: \"100%\", width: \"100%\", pointerEvents: \"none\"}}>\n        <Backdrop in={modalState} style={{height: \"calc(100vh - 56px)\"}}></Backdrop>\n        <Grow in={modalState}>\n          <div onClick={() => setModalOpen(false)} style={{pointerEvents: \"auto\", display: \"flex\", justifyContent: \"center\", alignItems: \"center\", height: \"calc(100vh - 56px)\"}}>\n            <div style={{position: \"relative\", padding: 0, backgroundColor: \"white\", borderRadius: \"13px\"}} onClick={(event) => event.stopPropagation()}>\n              <div className=\"closeButton\">\n                <IconButton size=\"small\" style={{padding: 1}} onClick={() => setModalOpen(false)}>\n                  <Cancel fontSize=\"inherit\" />\n                </IconButton>\n              </div>\n              <MapBox height=\"75vh\" width=\"80vw\" mapState={mapState}/>\n            </div>\n          </div>\n        </Grow>\n      </ div> : \n      null}\n\n      <div className='row'><div className=\"divBox\"><Typography variant='subtitle1'><b>Buttons for Testing:</b></Typography></div></div>\n      <div className=\"row\">\n        <div className=\"divBox\">\n          <Button onClick={() => addTestTrips()}>Add 3 Optimised Test Trips</Button>\n        </div>\n        <div className=\"divBox\">\n          <Button onClick={() => database.ref('trips/' + props.user.uid + '/').remove() }>Delete All Trips</Button>\n        </div>\n    </div>\n  </>\n  );\n}","import './App.css';\r\nimport React from 'react';\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport {Build, Eco, LocalShipping, HowToReg} from '@material-ui/icons';\r\nimport {Button, Card, Chip, Typography, CardContent, CardActions, Divider, Tooltip, Dialog, DialogTitle, DialogActions} from \"@material-ui/core\";\r\nimport { database } from './App';\r\nimport 'reactjs-popup/dist/index.css';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    Card: {\r\n      \"&.MuiCard-root:before\": {\r\n        backgroundColor: \"rgba(255, 255, 255, 0)\"\r\n      },\r\n      maxWidth: \"100%\"\r\n    }\r\n  }));\r\n\r\nexport default function VehicleCard(props) {\r\n    const vehicle = props.vehicle;\r\n    const make = props.vehicle.make;\r\n    const model = props.vehicle.model;\r\n    const year = props.vehicle.year;\r\n    const avgEmissions = props.vehicle.avgEmissionsPerKm;\r\n    var autoTransmission;\r\n    if (props.vehicle.autoTransmission){\r\n        autoTransmission = \"Auto\";\r\n    }\r\n    else {\r\n        autoTransmission = \"Manual\";\r\n    }\r\n\r\n    const [dialogState, setDialogState] = React.useState(false);\r\n    const handleClickDeleteButton = () => {\r\n        setDialogState(true);\r\n    };\r\n    const handleDialogClose = () => {\r\n        setDialogState(false);\r\n    };\r\n    const handleDelete = () => {\r\n        database.ref('vehicles/' + props.user.uid + '/' + vehicle.dbKey).remove(); \r\n        handleDialogClose();\r\n    }\r\n\r\n    return(\r\n        <Card className=\"roundedCorners\" classes={{root: useStyles().Card}}>\r\n            <CardContent>\r\n                <div style={{display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\", gap: 5}}>\r\n                <Chip variant=\"outlined\" color='primary' icon={<LocalShipping />}\r\n                    label ={<Typography variant=\"h5\" style={{margin: \"auto\"}}>\r\n                        {make + \" \" + model}\r\n                    </Typography>}\r\n                    />\r\n                </div>\r\n                <div className=\"row\">\r\n                    <Tooltip title=\"Manufacter\"><Chip label={make}/></Tooltip>\r\n                    <Tooltip title=\"Manufactored Year\"><Chip icon={<Build />} label={year}/></Tooltip>\r\n                    <Tooltip title=\"Auto Transmission?\"><Chip  label={autoTransmission.toString()}/></Tooltip>\r\n                    <Tooltip title=\"Avg Emissions\"><Chip icon={<Eco />} label={avgEmissions + \" grams of CO2/km\"}/></Tooltip>\r\n                </div>\r\n            </CardContent>\r\n            <Divider />\r\n            <CardActions>\r\n                <Button size=\"small\" color=\"secondary\" style={{marginLeft: \"auto\"}} onClick={() => handleClickDeleteButton()}>Remove Vehicle</Button>\r\n            </CardActions>\r\n            <Dialog open={dialogState} onClose={handleDialogClose}>\r\n                <DialogTitle >Are you sure you want to delete this vehicle?</DialogTitle>\r\n                <DialogActions>\r\n                <Button onClick={handleDialogClose} color=\"primary\">\r\n                    Cancel\r\n                </Button>\r\n                <Button onClick={handleDelete} color=\"secondary\" autoFocus>\r\n                    Delete\r\n                </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        </Card>\r\n    )\r\n\r\n}\r\n","import './App.css';\r\nimport React from 'react';\r\nimport {Button, TextField, InputAdornment, MenuItem, Typography, LinearProgress, Grow} from \"@material-ui/core\";\r\nimport { getExampleCars , Vehicle} from './Classes';\r\nimport VehicleCard from './FleetPageComponents';\r\nimport { database } from './App';\r\nimport Popup from 'reactjs-popup';\r\n\r\n\r\nfunction filterVehicles(filter, allVehicles, currentVehicles) {\r\n  if (filter[0] !== \"\"){\r\n    return allVehicles.filter(vehicle => {\r\n      console.log(vehicle.make);\r\n      if (filter[0] === vehicle.make) {\r\n        return filter[0] === vehicle.make;\r\n      }\r\n      else if (filter[0] === vehicle.model) {\r\n        return filter[0] === vehicle.model;\r\n      }\r\n      else if (filter[0] === vehicle.make + \" \" + vehicle.model) {\r\n        return filter[0] === vehicle.make + \" \" + vehicle.model;\r\n      }\r\n    });\r\n  }\r\n  if (filter[0] === \"\"){\r\n    return allVehicles;\r\n  }\r\n  else {\r\n    return currentVehicles;\r\n  }\r\n}\r\n\r\nexport default function Fleet(props) {\r\n  const [filter, setFilter] = React.useState([\"\", true]);\r\n  const [filteredVehicles, setVehicles] = React.useState([]);\r\n  const [allVehicles, setAllVehicles] = React.useState([]);\r\n  const [stillLoading, setStillLoading] = React.useState(true);\r\n  const [showFleet, setShowFleet] = React.useState(false);\r\n\r\n  const [transmission, setTransmission] = React.useState('');\r\n  const handleTransmissionSelect = (event) => {\r\n    setTransmission(event.target.value);\r\n    document.getElementById(\"newVehicleTransmission\").setAttribute(\"value\", event.target.value);\r\n  };\r\n\r\n  const [expanded, setExpanded] = React.useState(false);\r\n  const handleChange = (panel) => (event, isExpanded) => {\r\n    setExpanded(isExpanded ? panel : false);\r\n  };\r\n\r\n  const addVehicle = () => {\r\n    const make = document.getElementById(\"newVehicleMake\").value;\r\n    const model = document.getElementById(\"newVehicleModel\").value;\r\n    const year = document.getElementById(\"newVehicleYear\").value;\r\n    const avgEmissions = document.getElementById(\"newVehicleEmissions\").value;\r\n    const transmission = document.getElementById(\"newVehicleTransmission\").getAttribute(\"value\") === 1 ? true : false;\r\n    let newVehicle = new Vehicle(make, model, year, transmission, avgEmissions);\r\n    props.addToDatabase('vehicles/', JSON.stringify(newVehicle));\r\n  }\r\n\r\n  React.useEffect(() =>\r\n  database.ref(\"vehicles/\" + props.user.uid).on(\"value\", snapshot => {\r\n    let allVehicles = [];\r\n    if (snapshot) {\r\n      snapshot.forEach(snap => {\r\n        let i = new Vehicle(); \r\n        i.objectToInstance(JSON.parse(snap.val().data), snap.key);\r\n        allVehicles.push(i); \r\n        }\r\n      );\r\n    }\r\n    setAllVehicles(allVehicles);\r\n    setVehicles(filterVehicles(filter, allVehicles, filteredVehicles));\r\n    setFilter([filter[0], false]);\r\n    setExpanded(false);\r\n    setStillLoading(false);\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }), [])\r\n\r\n  let vehicleComponents = [];\r\n  if (stillLoading) {\r\n    vehicleComponents = <LinearProgress className='progressBar'/>\r\n  }\r\n  else {\r\n    for (let i = 0; i < filteredVehicles.length; i++) {\r\n      vehicleComponents.push(\r\n        <Grow in={showFleet} {...(showFleet ? { timeout: Math.min(200 + (i*500), 5000) } : {})} >\r\n          <div>\r\n            <VehicleCard vehicle={filteredVehicles[i]} id={i} changeHandler={handleChange} expanded={expanded} user={props.user}/>\r\n            <div style={{margin: 4}}></div>\r\n          </div>\r\n        </Grow>\r\n      );\r\n    };\r\n    if (vehicleComponents.length === 0){\r\n      vehicleComponents = <Typography variant=\"h6\">No Vehicles to Show</Typography>;\r\n    }\r\n    if (!showFleet) {setShowFleet(true)}\r\n  }\r\n\r\n  const dummyVehicles = getExampleCars();\r\n  const addTestVehicles = () => {\r\n    for (let i = 0; i < dummyVehicles.length; i++){\r\n      props.addToDatabase('vehicles/', JSON.stringify(dummyVehicles[i]));\r\n    }\r\n  }\r\n\r\n  if (filter[1]) {\r\n    var vehicles = filterVehicles(filter, allVehicles, filteredVehicles);\r\n    setVehicles(vehicles);\r\n    setFilter([\"\", false]);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"row\" style={{marginCenter: \"auto\"}}>\r\n        <div className=\"divBox\" style={{minWidth: \"40%\", height:36, marginRight: \"auto\"}}>\r\n          <TextField id=\"searchField\" label=\"Search Vehicle\" action=\"/\" type=\"search\" method=\"get\" style={{minWidth: \"70%\", fontSize: \"16px\", marginBottom: 10}}></TextField>\r\n          <Button type=\"submit\" variant=\"contained\" color=\"secondary\" onClick={() => setFilter([document.getElementById(\"searchField\").value, true])}>Search</Button>\r\n        </div>\r\n        \r\n        <div className=\"divBox\">\r\n          <Popup\r\n            trigger={\r\n            <Button variant=\"contained\" color=\"secondary\">\r\n              Add Vehicle\r\n            </Button>}\r\n            modal\r\n            nested\r\n          >\r\n            {close => (\r\n              <div className=\"modal\">\r\n                <button className=\"close\" onClick={close}>\r\n                  &times;\r\n                </button>\r\n                <div className=\"header\"> NEW VEHICLE </div>\r\n                <div className=\"content\">\r\n                  {' '}\r\n                  <div className=\"row\" style={{align: \"center\"}}>\r\n                    <TextField id=\"newVehicleMake\" label=\"Brand\" action=\"/\" method=\"get\" InputProps={{shrink: true}} variant=\"filled\" style={{minWidth: \"40%\", fontSize: \"16px\", marginBottom: 10}}></TextField>\r\n                    <TextField id=\"newVehicleModel\" label=\"Model\" action=\"/\" method=\"get\" InputProps={{shrink: true}} variant=\"filled\" style={{minWidth: \"40%\", fontSize: \"16px\", marginBottom: 10}}></TextField>\r\n                    <TextField id=\"newVehicleYear\" label=\"Manufactored Year\" type=\"number\" min=\"2000\" max=\"2021\" action=\"/\" method=\"get\" InputProps={{shrink: true}} variant=\"filled\" style={{minWidth: \"40%\", fontSize: \"16px\", marginBottom: 10}}></TextField>\r\n                    <TextField id=\"newVehicleEmissions\" label=\"Average Emissions\" type=\"number\" action=\"/\" method=\"get\" InputProps={{endAdornment: <InputAdornment position=\"end\">Grams of CO2/Km</InputAdornment>, shrink: true}} variant=\"filled\" style={{minWidth: \"40%\", fontSize: \"16px\", marginBottom: 10}}></TextField>\r\n                    <TextField id=\"newVehicleTransmission\" label=\"Transmissions\" select value={transmission} onChange={handleTransmissionSelect} variant=\"filled\" style={{minWidth: \"40%\", fontSize: \"16px\", marginBottom: 10}}>\r\n                      <MenuItem value={0}>Manual</MenuItem>\r\n                      <MenuItem value={1}>Auto</MenuItem>\r\n                    </TextField>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"actions\">\r\n                  <Button\r\n                    variant=\"contained\" \r\n                    color=\"secondary\"\r\n                    style={{marginLeft: 20}}\r\n                    onClick={() => {\r\n                      close();\r\n                    }}\r\n                  > Cancel\r\n                  </Button>\r\n                  <Button \r\n                    variant=\"contained\" \r\n                    color=\"secondary\" \r\n                    style={{marginLeft: 20}}\r\n                    onClick={addVehicle}\r\n                  > Confirm \r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </Popup>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"row\" style={{width:\"100%\"}}>\r\n        <div className={`divBox vehicleList`} style={{width:\"100%\", margin:\"auto\"}}>\r\n            {vehicleComponents}\r\n        </div>\r\n      </div>\r\n\r\n      <div className='row'><div className=\"divBox\"><Typography variant='subtitle1'><b>Buttons for Testing:</b></Typography></div></div>\r\n      <div className=\"row\">\r\n        <div className=\"divBox\">\r\n          <Button onClick={() => addTestVehicles()}>Add Some Test Cars</Button>\r\n        </div>\r\n        <div className=\"divBox\">\r\n          <Button onClick={() => database.ref('vehicles/' + props.user.uid + '/').remove() }>Delete All Cars</Button>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n","import '../App.css';\r\nimport React from 'react';\r\nimport { Typography, Select, FormControl, MenuItem, InputLabel } from \"@material-ui/core\";\r\nimport { DatePicker } from \"@material-ui/pickers\";\r\n\r\nfunction calculateMonthStats(trips, month, year) {\r\n    var max = 0;\r\n    var min = trips.length === 0 ? 0 : Number.POSITIVE_INFINITY;\r\n    var total = 0;\r\n    for (let i = 0; i < trips.length; i++) {\r\n        if (trips[i].date.getMonth() === month && trips[i].date.getFullYear() === year.getFullYear()) {\r\n            total += trips[i].emissions;\r\n            max = Math.max(max, trips[i].emissions);\r\n            min = Math.min(min, trips[i].emissions);\r\n        }\r\n    }\r\n    var avg = Math.round(total/30);\r\n    return [total, avg, max, min]\r\n}\r\n\r\nexport default function Report(props) {\r\n    const [selectedYear, setYear] = React.useState(new Date());\r\n    const [selectedMonth, setMonth] = React.useState(12);\r\n    const [avg, setAvg] = React.useState(0);\r\n    const [max, setMax] = React.useState(0);\r\n    const [min, setMin] = React.useState(0);\r\n    const [total, setTotal] = React.useState(0);\r\n    const trips = props.trips;\r\n    React.useEffect(() => {\r\n        if (selectedMonth === 12) {  // If all months is selected\r\n            let [max, min, total] = [0,Number.POSITIVE_INFINITY,0];\r\n            for (let i = 0; i < 12; i++) {\r\n                let [mtotal] = calculateMonthStats(trips, i, selectedYear);\r\n                total += mtotal;\r\n                max = Math.max(max, mtotal);\r\n                if (mtotal !== 0) min = Math.min(min, mtotal);\r\n            }\r\n            var avg = Math.round(total/12);\r\n            setAvg(avg);\r\n            setMax(max);\r\n            setMin(min === Number.POSITIVE_INFINITY ? 0 : min);\r\n            setTotal(total);\r\n        }\r\n        else {\r\n            const [total, avg, max, min] = calculateMonthStats(trips, selectedMonth, selectedYear);\r\n            setAvg(avg);\r\n            setMax(max);\r\n            setMin(min === Number.POSITIVE_INFINITY ? 0 : min);\r\n            setTotal(total);\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [selectedMonth, selectedYear, trips]);\r\n    return (\r\n        <>\r\n            <div style={{marginBottom: 10}}>\r\n                <div className=\"row\">\r\n                    <FormControl variant=\"outlined\" >\r\n                        <InputLabel>Month</InputLabel>\r\n                        <Select\r\n                        value={selectedMonth}\r\n                        onChange={(e) => setMonth(e.target.value)}\r\n                        label=\"Month\"\r\n                        >\r\n                            <MenuItem value={12}>All Months</MenuItem>\r\n                            <MenuItem value={0}>January</MenuItem>\r\n                            <MenuItem value={1}>February</MenuItem>\r\n                            <MenuItem value={2}>March</MenuItem>\r\n                            <MenuItem value={3}>April</MenuItem>\r\n                            <MenuItem value={4}>May</MenuItem>\r\n                            <MenuItem value={5}>June</MenuItem>\r\n                            <MenuItem value={6}>July</MenuItem>\r\n                            <MenuItem value={7}>August</MenuItem>\r\n                            <MenuItem value={8}>September</MenuItem>\r\n                            <MenuItem value={9}>October</MenuItem>\r\n                            <MenuItem value={10}>November</MenuItem>\r\n                            <MenuItem value={11}>December</MenuItem>\r\n                        </Select>\r\n                    </FormControl>\r\n                    <DatePicker\r\n                    variant=\"inline\"\r\n                    inputVariant=\"outlined\"\r\n                    views={[\"year\"]}\r\n                    label=\"Year\"\r\n                    value={selectedYear}\r\n                    onChange={setYear}\r\n                    />\r\n                </div>\r\n            </div>\r\n            <div className=\"fillRow\">\r\n                <Statistic title={'Average per '+ (selectedMonth === 12 ? 'Month' : 'Day') + ':'} value={avg < 1000 ? avg + \"g\" : Math.round((avg/1000) * 10) / 10 + \"kgs\"}/>\r\n                <Statistic title={(selectedMonth === 12 ? 'Highest Month' : 'Max Emissions in a Day') + ':'} value={max < 1000 ? max + \"g\" : Math.round((max/1000) * 10) / 10 + \"kgs\"}/>\r\n                <Statistic title={(selectedMonth === 12 ? 'Lowest (Active) Month' : 'Min Emissions in an (Active) Day') + ':'} value={min < 1000 ? min + \"g\" : Math.round((min/1000) * 10) / 10 + \"kgs\"}/>\r\n                <Statistic title='Total Emissions: ' value={total < 1000 ? total + \"g\" : Math.round((total/1000) * 10) / 10 + \"kgs\"}/>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nfunction Statistic(props) {\r\n    return (\r\n        <div className=\"divBox\" style={{width: \"20%\", minHeight: 80, boxShadow: \"none\"}}>\r\n            <Typography variant=\"body2\"><b>{props.title}</b></Typography>\r\n            <Typography color='primary' variant=\"h5\" style={{color:\"#8884d8\"}}><b>{props.value}</b></Typography>\r\n        </div>\r\n    )\r\n}","import './App.css';\r\nimport { LineChart, BarChart, Bar, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\r\nimport { Trip } from './Classes';\r\nimport Report from './components/Report';\r\nimport { database } from './App';\r\nimport React from 'react';\r\nimport { FormControl, InputLabel, Select, MenuItem, RadioGroup, Radio, FormControlLabel, FormLabel} from \"@material-ui/core\";\r\n\r\n\r\nexport default function Analysis(props) {\r\n  const [data, setData] = React.useState([]);\r\n  const [monthly, setMonthly] = React.useState([]);\r\n  const [yearly, setYearly] = React.useState([]);\r\n  const [maximum, setMaximum] = React.useState(0);\r\n  const [minimum, setMinimum] = React.useState(Number.POSITIVE_INFINITY);\r\n  const [graphType, setGraphType] = React.useState(\"line\");\r\n  const [graphPeriod, setPeriod] = React.useState(0);\r\n  const [trips, setTrips] = React.useState([]);\r\n\r\n  React.useEffect(() => {\r\n    switch (graphPeriod) {\r\n      case 0:\r\n        setData(monthly);\r\n        break\r\n      case 1:\r\n        setData(yearly);\r\n        break\r\n      default:\r\n        break;\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [graphPeriod])\r\n\r\n  React.useEffect(() =>\r\n    database.ref(\"trips/\" + props.user.uid).on(\"value\", snapshot => {\r\n      let allTrips = [];\r\n\r\n      if (snapshot) {\r\n        snapshot.forEach(snap => {\r\n          let i = new Trip();\r\n          i.objectToInstance(JSON.parse(snap.val().data), snap.key);\r\n          allTrips.push(i);\r\n        }\r\n        );\r\n      }\r\n\r\n      setTrips(allTrips);\r\n\r\n      const a = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\r\n     \r\n      const yearly = []\r\n      const monthly = []\r\n      for (let i = 0; i < allTrips.length; i++) {\r\n        let found = false;\r\n        for (let j = 0; j < monthly.length; j++){\r\n          if (monthly[j][\"name\"] == a[allTrips[i].date.getMonth()] + \" \" + allTrips[i].date.getFullYear()){\r\n              monthly[j][\"Gas\"] += allTrips[i].emissions;\r\n              found = true\r\n              break;\r\n          }\r\n        }\r\n        if (found == false){\r\n          monthly.push({ name: a[allTrips[i].date.getMonth()] + \" \" + allTrips[i].date.getFullYear(), Gas: allTrips[i].emissions })\r\n        }\r\n        \r\n      }\r\n      for (let i = 0; i < allTrips.length; i++) {\r\n        let foundd = false;\r\n        for (let j = 0; j< yearly.length; j++){\r\n          if (yearly[j][\"name\"] == allTrips[i].date.getFullYear()){\r\n            yearly[j][\"Gas\"] += allTrips[i].emissions;\r\n            foundd = true;\r\n            break\r\n          }\r\n        }\r\n        if (foundd == false){\r\n          yearly.push({ name: allTrips[i].date.getFullYear(), Gas: allTrips[i].emissions })\r\n        }\r\n        \r\n      }\r\n\r\n      let avg = 0;\r\n      for (let i = 0; i < allTrips.length; i++) {\r\n        if (allTrips[i].emissions < minimum) {\r\n          setMinimum(allTrips[i].emissions)\r\n        }\r\n        if (allTrips[i].emissions > maximum) {\r\n          setMaximum(allTrips[i].emissions)\r\n        }\r\n        avg += allTrips[i].emissions\r\n      }\r\n      setMonthly(monthly)\r\n      setYearly(yearly)\r\n      setData(monthly) // Default to monthly graph\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }), [])\r\n\r\n  return (\r\n    <>\r\n      <div className=\"row\">\r\n        <div className=\"divBox\" style={{ width: \"100%\", padding: 20}}>\r\n          <h3 style={{ marginTop: 0 }}>Statistics Dashboard</h3>\r\n            <Report trips={trips} />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"row\">\r\n        <div className=\"divBox\" style={{ width: \"100%\", padding: 20 }}>\r\n          <h3 style={{ marginTop: 0 }}>Emissions Graph</h3>\r\n          <div style={{marginBottom: 10}}>\r\n            <FormControl variant=\"outlined\" style={{minWidth: \"15%\", marginRight: 20}}>\r\n              <InputLabel>Period</InputLabel>\r\n              <Select\r\n                value={graphPeriod}\r\n                onChange={(e) => setPeriod(e.target.value)}\r\n                label=\"Period\"\r\n              >\r\n                <MenuItem value={0}>Monthly</MenuItem>\r\n                <MenuItem value={1}>Yearly</MenuItem>\r\n              </Select>\r\n            </FormControl>\r\n            <FormControl component=\"fieldset\">\r\n              <FormLabel component=\"legend\">Graph Type:</FormLabel>\r\n              <RadioGroup row defaultValue=\"line\" onChange={(e) => setGraphType(e.target.value)}>\r\n                <FormControlLabel value=\"line\" control={<Radio color=\"primary\" />} label=\"Line\" />\r\n                <FormControlLabel value=\"bar\" control={<Radio color=\"primary\" />} label=\"Bar\" />\r\n              </RadioGroup>\r\n            </FormControl>\r\n          </div>\r\n          <ResponsiveContainer width=\"100%\" height={500}>\r\n            {graphType === \"bar\" ? \r\n            <BarChart\r\n              data={data}\r\n              margin={{ bottom: 15, right: 50, top: 20 }}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" />\r\n              <XAxis dataKey=\"name\" dy={10} />\r\n              <YAxis />\r\n              <Tooltip />\r\n              <Bar dataKey=\"Gas\" name=\"CO2 emitted\" unit=\"g\" fill=\"#8884d8\" />\r\n            </BarChart> :\r\n            <LineChart\r\n              data={data}\r\n              margin={{ bottom: 15, right: 50, top: 20 }}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" />\r\n              <XAxis dataKey=\"name\" dy={10} />\r\n              <YAxis />\r\n              <Tooltip />\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey=\"Gas\"\r\n                name=\"CO2 emitted\"\r\n                unit=\"g\"\r\n                stroke=\"green\"\r\n                activeDot={{ r: 8 }}\r\n              />\r\n            </LineChart>\r\n            }\r\n          </ResponsiveContainer>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n\r\n}","import './App.css';\nimport { database } from './App';\nimport React from 'react';\nimport {BottomNavigation, BottomNavigationAction, Typography, Dialog, DialogActions, DialogTitle, \n  Button, DialogContent, Avatar, Chip, Tooltip, Grow} from \"@material-ui/core\";\nimport {Map, Timeline, LocalShipping, ExitToApp} from '@material-ui/icons';\nimport Trips from './Trips';\nimport Fleet from './Fleet';\nimport Analysis from './Analysis'\n\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\n\nexport default function Main(props) {\n  const [navState, setValue] = React.useState(0);  // Set default state to 0\n  const [activePage, pageUpdater] = React.useState();\n  const [dialogState, setDialogState] = React.useState(false);\n\n  const handleClickLogout = () => {\n    setDialogState(true);\n  };\n\n  var user = props.firebase.auth().currentUser;\n  var photoURL = user.photoURL;\n  var username = user.displayName ? user.displayName : user.email\n  const addToDatabase = (path, data) => {\n    database.ref(path + user.uid).push({data});\n  }\n\n  const handleDialogClose = () => {\n    setDialogState(false);\n    pageUpdater(<Trips pageUpdater={pageUpdater} addToDatabase={addToDatabase} user={user} />);\n    setValue(0);\n  };\n\n  // Set default state of the page\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  React.useEffect(() => pageUpdater(<Trips pageUpdater={pageUpdater} addToDatabase={addToDatabase} user={user}/>), []);  // useEffect runs only on first render\n  \n  return (\n    <div>\n      <MuiPickersUtilsProvider utils={DateFnsUtils}> \n      <div className=\"App-content\">\n        <Grow in={true} timeout={700}>\n          <div>\n            {activePage}  {/* Page contents are retrieved from the activePage variable*/}\n            <div className=\"row\">\n              <div className=\"divBox\" style={{paddingTop: 0, paddingBottom:0}}>\n                <div className='row'>\n                  <Typography style={{marginTop: 3}}>Signed-in as: </Typography>\n                  <Tooltip title=\"Logout\"><Chip\n                    avatar={<Avatar src={photoURL} >{username[0].toUpperCase()}</Avatar>}\n                    color=\"primary\"\n                    label={<b>{username}</b>}\n                    onClick={handleClickLogout}\n                    variant=\"outlined\"\n                  /></Tooltip>\n                </div>\n              </div>\n            </div>\n          </div>\n        </Grow>\n      </div>\n      \n      </MuiPickersUtilsProvider>\n\n      <BottomNavigation showLabels value={navState} onChange={(event, newValue) => {\n        setValue(newValue);\n        switch(newValue) {\n          case 0:\n            pageUpdater(<Trips pageUpdater={pageUpdater} addToDatabase={addToDatabase} user={user} />);\n            break;\n          case 1:\n            pageUpdater(<Analysis pageUpdater={pageUpdater} addToDatabase={addToDatabase} user = {user}/>);\n            break;\n          case 2:\n            pageUpdater(<Fleet pageUpdater={pageUpdater} addToDatabase={addToDatabase} user={user}/>);\n            break;\n          case 3:\n            handleClickLogout();\n            break;\n          default:\n            pageUpdater(<Trips pageUpdater={pageUpdater}/>);\n        }\n      }} \n      className=\"bottomBar\">\n          <BottomNavigationAction label=\"Trips\" icon={<Map />} />\n          <BottomNavigationAction label=\"Analysis\" icon={<Timeline />} />\n          <BottomNavigationAction label=\"Fleet\" icon={<LocalShipping />} />\n          <BottomNavigationAction label=\"Logout\" icon={<ExitToApp />} />\n      </BottomNavigation>\n      <Dialog open={dialogState} onClose={handleDialogClose}>\n        <DialogTitle >Are you sure you want to logout?</DialogTitle>\n        <DialogContent>You are currently signed-in as <b>{username}</b></DialogContent>\n        <DialogActions>\n          <Button onClick={handleDialogClose} color=\"primary\">\n            Cancel\n          </Button>\n          <Button onClick={() => props.firebase.auth().signOut()} color=\"primary\" autoFocus>\n            Logout\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","import React from 'react';\r\nimport './index.css';\r\nimport Main from './Main';\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/auth\";\r\nimport \"firebase/database\";\r\nimport { FirebaseAuthProvider, IfFirebaseAuthed, IfFirebaseUnAuthed } from \"@react-firebase/auth\";\r\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth';\r\nimport {Typography, Snackbar, Grow } from \"@material-ui/core\";\r\nimport { createTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\n\r\n\r\nvar firebaseConfig = {\r\n    apiKey: \"AIzaSyBrec3dqroIgZLstvNTt14HsRRwHLFWw1w\",\r\n    authDomain: \"envirologistics-team17.firebaseapp.com\",\r\n    projectId: \"envirologistics-team17\",\r\n    storageBucket: \"envirologistics-team17.appspot.com\",\r\n    messagingSenderId: \"528290527068\",\r\n    appId: \"1:528290527068:web:f4c3fe45f5ad568f2eb399\",\r\n    databaseURL: \"https://envirologistics-team17-default-rtdb.asia-southeast1.firebasedatabase.app/\",\r\n    measurementId: \"G-9R4DEPNWPE\"\r\n  };\r\n  \r\nfirebase.initializeApp(firebaseConfig);\r\nexport const database = firebase.database();\r\n\r\nexport default function App(props) { \r\n    const [msgState, setMsgOpen] = React.useState(false);\r\n\r\n    const handleLogin = () => {\r\n        setMsgOpen(true);\r\n        if (!firebase.auth().currentUser.emailVerified) {\r\n            firebase.auth().currentUser.sendEmailVerification();\r\n        }\r\n    };\r\n\r\n    const handleMsgClose = (event, reason) => {\r\n        if (reason === 'clickaway') {\r\n            return;\r\n        }\r\n\r\n        setMsgOpen(false);\r\n    };\r\n      \r\n    const loginUIConfig = {\r\n        signInFlow: 'popup',\r\n        signInOptions: [\r\n          firebase.auth.GoogleAuthProvider.PROVIDER_ID,\r\n          {\r\n            provider: firebase.auth.EmailAuthProvider.PROVIDER_ID,\r\n            requireDisplayName: false\r\n          },\r\n        ],\r\n        callbacks: {\r\n          signInSuccessWithAuthResult: handleLogin,\r\n        }\r\n      };\r\n\r\n    const theme = createTheme({\r\n        palette: {\r\n          primary: {\r\n            main: '#614385',\r\n          },\r\n          secondary: {\r\n            main: '#9a53a0',\r\n          },\r\n        },\r\n      });\r\n    return (\r\n        <FirebaseAuthProvider {...firebaseConfig} firebase={firebase}>\r\n            <ThemeProvider theme={theme}>\r\n                <IfFirebaseAuthed>\r\n                  <Main firebase={firebase} />\r\n                </IfFirebaseAuthed>\r\n                <IfFirebaseUnAuthed>\r\n                  <div className={`App-content`} style={{justifyContent: \"center\", alignItems: \"center\"}}>\r\n                    <Grow in={true} timeout={1000} style={{ transitionDelay: 100}}>\r\n                      <div>\r\n                        <div className=\"divBox\">\r\n                          <Typography variant=\"h6\" style={{textAlign: \"center\"}}>Welcome to EnviroLogistics</Typography>\r\n                          <Typography style={{textAlign: \"center\"}}>Please sign-in:</Typography>\r\n                          <StyledFirebaseAuth uiConfig={loginUIConfig} firebaseAuth={firebase.auth()} />\r\n                        </div>\r\n                      </div>\r\n                    </Grow>\r\n                  </div>\r\n                </IfFirebaseUnAuthed>\r\n                <Snackbar open={msgState} autoHideDuration={6000} onClose={handleMsgClose}>\r\n                    <MuiAlert elevation={6} variant=\"filled\" onClose={handleMsgClose} severity=\"success\">\r\n                        Sign-in successful. Welcome, {firebase.auth().currentUser == null ? \"\" : (firebase.auth().currentUser.displayName ? firebase.auth().currentUser.displayName: firebase.auth().currentUser.email)}\r\n                    </MuiAlert>\r\n                </Snackbar>\r\n            </ThemeProvider>\r\n        </FirebaseAuthProvider>\r\n    )\r\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\nreportWebVitals();\n"],"sourceRoot":""}